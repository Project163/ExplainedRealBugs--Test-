{"id":1098,"status":"Fixed","summary":"Memory leak from Tracer.ThreadTrace when useThreads is set to false","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":8,"comments":[{"id":0,"commenterId":1482372669392377590,"content":"copied from issue 685\r\n\r\nThe `ThreadLocal` is created from the `Tracer.getThreadTrace()` method which is called in the constructor.\r\nThe ThreadLocal is only removed from within `Tracer.clearThreadTrace`. This is called from `clearCurrentThreadTrace()` - which is completely unused - and from `logAndClearCurrentThreadTrace()`. The latter is only called from within the `bootCompilerThread` `Callable`. And that - despite being created unconditionally - is only used if `Compiler.useThreads` is `true`.\r\nThat means that if `Compiler.useThreads` is `false`, the `ThreadLocal` is created but never removed.","timestamp":1379918065,"attachments":[]},{"id":1,"commenterId":-5060162230523776870,"content":"Do you want to send a patch?","timestamp":1380067589,"attachments":[]},{"id":2,"commenterId":1482372669392377590,"content":"I tried to come up with a fix, but I\u0027m not entirely sure if it breaks anything. I have only skimmed through the code. But all the tests pass.","timestamp":1380095169,"attachments":[{"id":10980002000,"fileName":"0001-always-clear-ThreadTrace-at-the-end-of-an-operation.patch","fileSize":3557}]},{"id":3,"commenterId":-5060162230523776870,"content":"Can you sign a CLA for us?\r\nhttps://code.google.com/p/closure-compiler/wiki/Contributors","timestamp":1380241027,"attachments":[]},{"id":4,"commenterId":1482372669392377590,"content":"I did that last Friday.","timestamp":1380522408,"attachments":[]},{"id":5,"commenterId":-5060162230523776870,"content":"","timestamp":1380562217,"attachments":[]},{"id":6,"commenterId":-8769171937076622550,"content":"This issue was closed by revision 2d6e1c78f412.","timestamp":1380672082,"attachments":[]},{"id":7,"commenterId":-8769171937076622550,"content":"This issue was closed by revision 2d6e1c78f412.","timestamp":1381947639,"attachments":[]}]}