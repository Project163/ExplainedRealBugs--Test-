{"id":1255,"status":"Duplicate","summary":"Enum unfolding doesn\u0027t work in some cases","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":2,"comments":[{"id":0,"commenterId":4341000138820253941,"content":"I hope it\u0027s not too annoying posting all these tiny little bugs, but I try to keep code as verbose as possible and let the compressor do the rest. In this case I found a strange behavior, that CG doesn\u0027t unroll the following enum:\r\n\r\n(function(window) {\r\n\r\n/**\r\n*\r\n* @enum {number}\r\n*\r\n*/\r\nvar STATUS \u003d {\r\nPLAY: 0,\r\nPAUSE: 1,\r\nGAMEOVER: 2,\r\nWAIT: 3\r\n};\r\n\r\nfunction integratePiece() {\r\ngameStatus \u003d STATUS.GAMEOVER;\r\n}\r\n\r\nfunction loop() {\r\nintegratePiece();\r\nsetTimeout(loop, speed);\r\n}\r\n\r\nloop();\r\n\r\n})(this);\r\n\r\nIn simple mode I just get:\r\n\r\n(function(c){function a(){gameStatus\u003db.GAMEOVER;setTimeout(a,speed)}var b\u003d{PLAY:0,PAUSE:1,GAMEOVER:2,WAIT:3};a()})(this);\r\n\r\nAdvanced mode isn\u0027t much better:\r\n\r\n(function(){function a(){gameStatus\u003db.a;setTimeout(a,speed)}var b\u003d{c:0,b:1,a:2,d:3};a()})(this);\r\n\r\nI tried to add a @const annotation as well, without any effect.\r\n\r\nP.S.: The variables are all global because I reduced the code as much as possible to proof the problem. In the real code all the variables are defined in the closure.\r\n\r\nThanks!\r\n\r\nRobert","timestamp":1393286777,"attachments":[]},{"id":1,"commenterId":-5060162230523776870,"content":"This is a function declaration ordering issue.  Change this function declarations to var initializations:\r\n\r\nvar loop \u003d function() {...}\r\n\r\nFixes this issue. ","timestamp":1393520411,"attachments":[]}]}