{"id":583,"status":"Fixed","summary":"jquery1.6 extern file gives compiler warning","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":22,"comments":[{"id":0,"commenterId":-1353442159401489925,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n1. Include jquery1.6.js extern file (--extern jquery1.6.js)\r\n2. Compile\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\nCompiled code with no warning, instead:\r\njquery-1.6.js:292: WARNING - property clone already defined on superclass Object; use @override to override it\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\n21/Oct/2011\r\n\r\n\u003cb\u003ePlease provide any additional information below.\u003c/b\u003e\nAttached is the fix (added @override annotation)","timestamp":1319146430,"attachments":[{"id":5830000000,"fileName":"jquery-1.6.js.patch","fileSize":361}]},{"id":1,"commenterId":-7699928860083865744,"content":"i\u0027m thinking of just removing this warning, because it is not useful. thoughts?","timestamp":1319157456,"attachments":[]},{"id":2,"commenterId":-1353442159401489925,"content":"I have no problems with explicitly declaring an override.  It can help catch accidental overriding of a method.  Rare problem, I know but one that can be quite painful to debug.  I would vote to keep @override.","timestamp":1319159241,"attachments":[]},{"id":3,"commenterId":2220700227557109852,"content":"I\u0027m with Guido.","timestamp":1319163291,"attachments":[]},{"id":4,"commenterId":-7699928860083865744,"content":"I\u0027m assuming the problem is that you\u0027re compiling with both jquery and closure. Object.prototype.clone is defined in closure library\u0027s base.js\r\n\r\nIf we added this @override to jquery\u0027s externs, it would emit warnings for people that weren\u0027t compiling with closure. right?","timestamp":1319166541,"attachments":[]},{"id":5,"commenterId":-7699928860083865744,"content":"also, i assume you\u0027re turning on reportMissingOverrides from the java api? i can\u0027t make this happen from the command-line api, but maybe there\u0027s a way i\u0027m forgetting.","timestamp":1319167067,"attachments":[]},{"id":6,"commenterId":-1353442159401489925,"content":"Interesting, I never considered anyone using the compiler in advanced mode without using the closure libraries.  Can you currently add @suppress on extern files? Do we have a suppress for missing @overrides?","timestamp":1319167088,"attachments":[]},{"id":7,"commenterId":-1353442159401489925,"content":"@suppress {checkTypes} works and is attached","timestamp":1319167502,"attachments":[{"id":5830007000,"fileName":"jquery-1.6.js.patch","fileSize":374}]},{"id":8,"commenterId":-7699928860083865744,"content":"I\u0027ve always been reluctant to add @suppress annotations for correctly written code. It seems like a line that we shouldn\u0027t cross.","timestamp":1319174659,"attachments":[]},{"id":9,"commenterId":-1353442159401489925,"content":"So how would you approach this one?  I don\u0027t understand the requirement for the Object.prototype.clone declaration in base.js, is this really needed? Is this the real bug? I mean we are extending the Object prototype which violates closures \u0027I will not extend existing object prototypes\u0027 law.  I vote to delete the whole repository and start again from scratch (Maybe next time call it \u0027dart\u0027?)","timestamp":1319230607,"attachments":[]},{"id":10,"commenterId":-1353442159401489925,"content":"Ahh I had missed your \u0027reportMissingOverrides\u0027 post.\r\n\r\nYes, I have it turned on, would the answer be just turning this off for now? This would at least lower the criticality of this to pretty much nothing.  Its not great tho as I\u0027m kinda of the mind that the more compiler checks the better.  However, happy with that workaround for now.","timestamp":1319231034,"attachments":[]},{"id":11,"commenterId":-7699928860083865744,"content":"I think what I would like to do is just remove this warning for \"shared\" objects (like Object.prototype), where libraries commonly do define extra methods.","timestamp":1319395241,"attachments":[]},{"id":12,"commenterId":6454800031398885070,"content":"I think the proper thing to do is add an Object.prototype.clone to the jQuery externs and add the @Override with a note that the \"Object.prototype.clone\" declaration is added for Closure Library compatibility.  That would allow it to be used with or without.\r\n\r\nI do think however that the missing/extraneous override check should be controlable in its own diagnostic group, similar to the private and const checks.","timestamp":1319474644,"attachments":[]},{"id":13,"commenterId":1948758734812428220,"content":"Keeping up with the idea that no correctly written code should need workaround for the type system, I feel that whoever uses both closure and jquery should be the one using a work around.\r\n\r\n@johnlenz, how does adding @override in the jquery extern eliminate the problem? Don\u0027t you need to put the @override right at the function declaration?","timestamp":1319478729,"attachments":[]},{"id":14,"commenterId":-7699928860083865744,"content":"I would eventually like to remove the Object.prototype.clone from Closure Library. Ironically, the reason I can\u0027t currently remove it is because of this warning.","timestamp":1319485167,"attachments":[]},{"id":15,"commenterId":1948758734812428220,"content":"Nick: Can you explain your motivation for removing clone() in base.js? Is it just so that people can use both JQuery and Closure Lib? It seems like it acts as an abstract method for all it\u0027s subclass. It should enable the type checker and inferfancer to know that all object can be cloned.\r\n\r\nI feel that it makes seems for people who uses jquery + closurelib to put in workaround and @suppress.\r\n\r\nThoughts?","timestamp":1319579213,"attachments":[]},{"id":16,"commenterId":-7699928860083865744,"content":"The Object.prototype.clone was only added as a workaround for the legacy property checker (which is now deleted). It\u0027s going to make me very sad if we can never remove it.","timestamp":1319584890,"attachments":[]},{"id":17,"commenterId":-7699928860083865744,"content":"how would people feel if there was a way to annotate Object.prototype.clone to suppress this warning?","timestamp":1319585570,"attachments":[]},{"id":18,"commenterId":-1353442159401489925,"content":"So what is currently stopping the removal of Object.proto.clone? If its not needed anore why not just removed it?\r\n","timestamp":1319587843,"attachments":[]},{"id":19,"commenterId":-7699928860083865744,"content":"Because that will break everyone who currently has a clone method annotated as @override.\r\n\r\nWe try very hard not to introduce a change that is both backwards-incompatible and forwards-incompatible at the same time.","timestamp":1319591057,"attachments":[]},{"id":20,"commenterId":5466112693174441437,"content":"I would prefer not to add Object.prototype.clone to the  Jquery externs. That just seems like a workaround for a workaround.","timestamp":1320063924,"attachments":[]},{"id":21,"commenterId":-7699928860083865744,"content":"This issue was closed by revision r1600.","timestamp":1321470516,"attachments":[]}]}