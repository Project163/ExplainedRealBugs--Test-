{"id":1124,"status":"Fixed","summary":"DiagnosticGroup NullPointer","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":8,"comments":[{"id":0,"commenterId":-9126279717140834086,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\nThe error does not happen consistently. We were running the closure compiler in 2 threads, each with its own compiler options. Sometimes DiagnosticGroup throws a NullPointerExpception. We were running it with simple optimizations and warning level quiet.\r\n\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\nv20130722 running Jenkins on Solaris\r\n\r\n\u003cb\u003ePlease provide any additional information below.\u003c/b\u003e\nCaused by: java.lang.NullPointerException\r\n\tat com.google.javascript.jscomp.DiagnosticGroup.isSubGroup(DiagnosticGroup.java:117)\r\n\tat com.google.javascript.jscomp.DiagnosticGroupWarningsGuard.disables(DiagnosticGroupWarningsGuard.java:42)\r\n\tat com.google.javascript.jscomp.ComposeWarningsGuard.disables(ComposeWarningsGuard.java:130)\r\n\tat com.google.javascript.jscomp.CompilerOptions.disables(CompilerOptions.java:1175)\r\n\tat com.google.javascript.jscomp.Compiler.reconcileOptionsWithGuards(Compiler.java:317)\r\n\tat com.google.javascript.jscomp.Compiler.initOptions(Compiler.java:297)\r\n\tat com.google.javascript.jscomp.Compiler.initModules(Compiler.java:398)\r\n\tat com.google.javascript.jscomp.Compiler.init(Compiler.java:377)\r\n\tat com.google.javascript.jscomp.Compiler.compile(Compiler.java:599)\r\n\tat com.rightmove.closurecompiler.ClosureCompilerWorker.call(ClosureCompilerWorker.java:30)\r\n\tat com.rightmove.closurecompiler.ClosureCompilerWorker.call(ClosureCompilerWorker.java:14)\r\n\t... 5 more","timestamp":1382691007,"attachments":[]},{"id":1,"commenterId":-5060162230523776870,"content":"Were you sharing diagnostic class instances between the compiler options objects?  They really need to be \"owned\" by a compiler options object.","timestamp":1383091743,"attachments":[]},{"id":2,"commenterId":-9126279717140834086,"content":"No I was not using the diagnostics class directly. I was using CompilationLevel.setOptionsForCompilationLevel() and WarningLevel.setOptionsForWarningLevel() to update the compiler options. Each thread has its own instance of CompilerOptions","timestamp":1383124007,"attachments":[]},{"id":3,"commenterId":-7699928860083865744,"content":"I posted a fix here:\r\nhttps://codereview.appspot.com/21170043/","timestamp":1383410267,"attachments":[]},{"id":4,"commenterId":-9126279717140834086,"content":"Cool thanks for the update :)","timestamp":1383500496,"attachments":[]},{"id":5,"commenterId":-7699928860083865744,"content":"This issue was closed by revision bb893266036c.","timestamp":1383887308,"attachments":[]},{"id":6,"commenterId":-8769171937076622550,"content":"This issue was closed by revision 763faa34d5e6.","timestamp":1384540245,"attachments":[]},{"id":7,"commenterId":-7699928860083865744,"content":"This issue was closed by revision bb893266036c.","timestamp":1384541464,"attachments":[]}]}