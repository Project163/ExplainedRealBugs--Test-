{"id":178,"status":"Fixed","summary":"Incorrect line number reporting","labels":["Type-Defect","Priority-Medium","Component-Parser"],"stars":3,"commentCount":5,"comments":[{"id":0,"commenterId":-8565359677229908361,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n---- compile this ------------------------------------------------\r\n// \u003d\u003dClosureCompiler\u003d\u003d\r\n// @compilation_level ADVANCED_OPTIMIZATIONS\r\n// @output_file_name default.js\r\n// \u003d\u003d/ClosureCompiler\u003d\u003d\r\n/*\r\nline 1\r\nline 2\r\n..\r\nThis comment seems to disturb line nr reporting\r\n*/\r\n\r\n/**\r\n* provoke error in annotation\r\n* @param {UNKNOWN_TYPE} name \u0026lt;- error this is not line 5, it is line 9\r\n*/\r\nfunction hello(name) {\r\n    SYNTAX-ERROR-ON-LINE-13-OK\r\n}\r\n\r\nhello(\u0027New user\u0027);\r\n----- end code ----------------------------------------------\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\nShould get two error/warnings. One on line 9 and one on line 13.\r\nBoth errors are found but first annotation error is reported to be on line 5 instead of line 9. \r\n\r\n-----compiler output -----\r\nNumber of warnings: 2\r\n\r\nJSC_PARSE_ERROR: Parse error. Unknown type UNKNOWN_TYPE at line 5 character 10\r\nThis comment seems to disturb line nr reporting\r\n          ^\r\nJSC_USELESS_CODE: Suspicious code. This code lacks side-effects. Is there a bug? at line 13 character 19\r\nSYNTAX-ERROR-ON-LINE-13-OK\r\n----------------------------\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\nBoth the 20100514 release and online compiler.\r\n\r\n\u003cb\u003ePlease provide any additional information below.\u003c/b\u003e\n\r\nThe annotation error reporter seems to treat any preceding comment\r\nas single-line when it calculates line numbers. \r\n(Same in both SIMPLE and ADVANCED mode, just depending what errors are triggered).\r\n\r\nRegards\r\n// Fredrik Blomqvist","timestamp":1276528604,"attachments":[]},{"id":1,"commenterId":-5060162230523776870,"content":"Assigning this to Alan until proven that his Rhino patch doesn\u0027t fix this.","timestamp":1277319525,"attachments":[]},{"id":2,"commenterId":-5060162230523776870,"content":"","timestamp":1285977581,"attachments":[]},{"id":3,"commenterId":-5060162230523776870,"content":"Still reproducible.","timestamp":1301524616,"attachments":[]},{"id":4,"commenterId":-7699928860083865744,"content":"This issue was closed by revision r1149.","timestamp":1306943666,"attachments":[]}]}