{"id":491,"status":"Fixed","summary":"Compiler keeps code for all locales under advanced optimizations","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":5,"comments":[{"id":0,"commenterId":-4012403339995796131,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n1. write some js code that requires goog.i18n.DateTimeSymbols (I am not so sure about the minimal code, I discovered this bug compiling a big project)\r\n2. compile it with advanced optimizations option\r\n3. check out the compiled code\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\nThere shouldn\u0027t be code for other locales. But code for all locales are there, generated file size is 100+K bigger than it should be. Maybe because I don\u0027t use them, they don\u0027t have variable names. generated code example are as follows:\r\n\u0026quot;\\u062c\\u0646\\u0648\\u0631\\u06cc,\\u0641\\u0631\\u0648\\u0631\\u06cc,\\u0645\\u0627\\u0631 \\u0686,\\u0627\\u067e\\u0631\\u064a\\u0644,\\u0645\\u0626,\\u062c\\u0648\\u0646,\\u062c\\u0648\\u0644\\u0627\\u0626,\\u0627\\u06af\\u0633\\u062a,\\u0633\\u062a\\u0645\\u0628\\u0631,\\u0627\\u06a9\\u062a\\u0648\\u0628\\u0631,\\u0646\\u0648\\u0645\\u0628\\u0631,\\u062f\\u0633\\u0645\\u0628\\u0631\u0026quot;.split(\u0026quot;,\u0026quot;);\u0026quot;\\u062c\\u0646\\u0648\\u0631\\u06cc,\\u0641\\u0631\\u0648\\u0631\\u06cc,\\u0645\\u0627\\u0631 \\u0686,\\u0627\\u067e\\u0631\\u064a\\u0644,\\u0645\\u0626,\\u062c\\u0648\\u0646,\\u062c\\u0648\\u0644\\u0627\\u0626,\\u0627\\u06af\\u0633\\u062a,\\u0633\\u062a\\u0645\\u0628\\u0631,\\u0627\\u06a9\\u062a\\u0648\\u0628\\u0631,\\u0646\\u0648\\u0645\\u0628\\u0631,\\u062f\\u0633\\u0645\\u0628\\u0631\u0026quot;.split(\u0026quot;,\u0026quot;);\r\n\r\na lot of them: \u0026quot;long string\u0026quot;.split(\u0026quot;.\u0026quot;); which do nothing and makes no sense.\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\nWith experiments, i can confirm this became a problem after r1183 is committed. My project compiles to 470K with r1182,  573K with r1183.\r\n","timestamp":1308657026,"attachments":[]},{"id":1,"commenterId":1948758734812428220,"content":"Strange. It might be related to a recent change in how the compiler handles split()","timestamp":1308864446,"attachments":[]},{"id":2,"commenterId":-7699928860083865744,"content":"@alan: shouldn\u0027t that code live in one of the \"late\" compiler passes? I don\u0027t think it should run in every optimize loop.","timestamp":1309106230,"attachments":[]},{"id":3,"commenterId":-215138502632663007,"content":"Oops. One of the flag was wrong. I just checked in a fix.","timestamp":1309249633,"attachments":[]},{"id":4,"commenterId":1328304962299559429,"content":"This issue was closed by revision r1231.","timestamp":1309464594,"attachments":[]}]}