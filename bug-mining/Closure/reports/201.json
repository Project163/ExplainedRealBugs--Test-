{"id":714,"status":"Fixed","summary":"Using --process_common_js_modules produces a regex exception when used on Windows","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":6,"comments":[{"id":0,"commenterId":-349948520796689365,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n1.Use command line arguments \r\n  --process_common_js_modules \r\n  --common_js_entry_module\u003dmain.js\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\nAn exception is thrown.\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\nOS: Windows\r\n\r\nAdditional Info:\r\nIn file com.google.javascript.jscomp.ProcessCommonJSModules\r\nFile.separator needs to be replaced or further escaped on Windows.\r\n\r\n\r\nFull Stack Trace:\r\nException in thread \u0026quot;main\u0026quot; java.util.regex.PatternSyntaxException: Unexpected internal error near index 4\r\n^\\.\\\r\n    ^\r\n        at java.util.regex.Pattern.error(Unknown Source)\r\n        at java.util.regex.Pattern.compile(Unknown Source)\r\n        at java.util.regex.Pattern.\u0026lt;init\u0026gt;(Unknown Source)\r\n        at java.util.regex.Pattern.compile(Unknown Source)\r\n        at java.lang.String.replaceAll(Unknown Source)\r\n        at com.google.javascript.jscomp.ProcessCommonJSModules.toModuleName(ProcessCommonJSModules.java:83)\r\n        at com.google.javascript.jscomp.CommandLineRunner.initConfigFromFlags(CommandLineRunner.java:656)\r\n        at com.google.javascript.jscomp.CommandLineRunner.\u0026lt;init\u0026gt;(CommandLineRunner.java:556)\r\n        at com.google.javascript.jscomp.CommandLineRunner.main(CommandLineRunner.java:869)","timestamp":1335223437,"attachments":[]},{"id":1,"commenterId":-349948520796689365,"content":"Potential Patch is attached.  It works for me on Windows.\r\n\r\nI did not run the unit tests and I have not tested it on Linux.\r\n\r\n","timestamp":1335234403,"attachments":[{"id":7140001000,"fileName":"patch714.txt","fileSize":1909}]},{"id":2,"commenterId":-5060162230523776870,"content":"Neaket do you have a CLA as per: \r\nhttp://code.google.com/p/closure-compiler/wiki/Contributors","timestamp":1335279879,"attachments":[]},{"id":3,"commenterId":-7699928860083865744,"content":"i can probably guess what the fix to this is too without looking at the patch.","timestamp":1335475755,"attachments":[]},{"id":4,"commenterId":-349948520796689365,"content":"I have just submitted a CLA, and it is now being processed.  \r\n\r\n@Nicholas \r\nYes the fix is straight forward a few lines of code.  A backslash needs to be double escaped for windows directories in regex.  And a forward slash is always used for module paths (which are web based).","timestamp":1335477403,"attachments":[]},{"id":5,"commenterId":-7699928860083865744,"content":"This issue was closed by revision r1927.","timestamp":1335544721,"attachments":[]}]}