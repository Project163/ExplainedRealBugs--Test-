{"id":11,"status":"Fixed","summary":"fails to build from source without binary blobs","labels":["Type-Defect","Priority-Medium"],"stars":2,"commentCount":11,"comments":[{"id":0,"commenterId":1602844443185143326,"content":"The closure-compiler source contains compiled classes. If these are removed\r\nthe build fails:\r\n\r\n$ rm --force lib/google_common_deploy.jar\r\nlib/google_compiled_protos_deploy.jar lib/junit.jar\r\nlib/libtrunk_rhino_parser_jarjared.jar tools/FlagProcessorFactory_deploy.jar\r\n$ ant jar\r\n    [...]\r\n    [javac] [...]: package com.google.common.annotations does not exist\r\n    [javac] [...]: package com.google.common.base does not exist\r\n    [javac] [...]: package com.google.common.collect does not exist\r\n    [javac] [...]: package com.google.common.flags does not exist\r\n    [javac] [...]: package com.google.common.io does not exist\r\n    [javac] [...]: package com.google.javascript.jscomp.mozilla.rhino does\r\nnot exist\r\n    [...]\r\n\r\nThanks,\r\n\r\nNicholas\r\n","timestamp":1257518583,"attachments":[]},{"id":1,"commenterId":-7699928860083865744,"content":"Closure Compiler depends on 2 major libraries:\r\n\r\nGuava\r\nhttp://code.google.com/p/guava-libraries/\r\n\r\nand Rhino\r\nhttp://www.mozilla.org/rhino/\r\n\r\nThe maintainers of those libraries asked us to include the compiled JARs, and not the \r\nsource code, in our repository. (We depend on some new things in Rhino trunk, and \r\nthey aren\u0027t in any compiled release). I\u0027ll try to clarify this more in the README.\r\n\r\nIs there some other reason you need to remove the binary blobs?","timestamp":1257535725,"attachments":[]},{"id":2,"commenterId":-7699928860083865744,"content":"","timestamp":1257535736,"attachments":[]},{"id":3,"commenterId":1602844443185143326,"content":"Hi, thanks for your comments.\r\n\r\n\u003e Is there some other reason you need to remove the binary blobs?\r\n\r\nI intend to package this software for the Debian project. This will require the full\r\nsource for the compiler and all its dependencies, and all scripts necessary to build\r\nfrom source. As I understand it, closure-compiler depends on guava-libraries, which\r\ndepends on google-collections, which depends on google-web-toolkit, which depends on\r\n\"prerequisite tools and third-party libraries\", which includes a lot of precompiled\r\nclasses and shared objects.\r\n\r\nThanks,\r\n\r\nNicholas\r\n","timestamp":1257605692,"attachments":[]},{"id":4,"commenterId":1602844443185143326,"content":"Hi, thanks for the notes in the README. The source files for the following classes in\r\ngoogle_common_deploy.jar and google_compiled_protos_deploy.jar, which are required to\r\nbuild closure-compiler, are not in google-collections or guava-libraries:\r\n\r\n    com.google.common.base.Join\r\n    com.google.common.base.Pair\r\n    com.google.common.base.StringUtil\r\n    com.google.common.base.Tracer\r\n    com.google.common.base.X\r\n    com.google.common.collect.ImmutableMapBuilder\r\n    com.google.common.flags.DocLevel\r\n    com.google.common.flags.Flag\r\n    com.google.common.flags.FlagSpec\r\n    com.google.common.primitives.IntStack\r\n    com.google.javascript.jscomp.FunctionInformationMap\r\n    com.google.protobuf.CodedOutputStream\r\n    com.google.protobuf.TextFormat\r\n\r\nThanks,\r\n\r\nNicholas\r\n","timestamp":1257900518,"attachments":[]},{"id":5,"commenterId":-7699928860083865744,"content":"Some of that is protobuf code, which I forgot that Antonio had added. I\u0027ll add it to \r\nthe README.\r\nhttp://code.google.com/p/protobuf/source/browse/#svn/trunk/java/src/main/java/com/googl\r\ne/protobuf\r\n\r\nAs for the rest, it\u0027s entirely possible that the Guava people got slowed down and \r\nhaven\u0027t actually put the code into their SVN repository yet. I\u0027ll go have a chat with \r\nthem tomorrow.","timestamp":1257906698,"attachments":[]},{"id":6,"commenterId":-189835140468615108,"content":"Any update on this ? Where is the source code for com.google.common.flags for example ?\r\n\r\nI\u0027m also trying to avoid using the google_common_deploy.jar binary but it seems the\r\nsources for all the needed classes aren\u0027t available anywhere.","timestamp":1265880358,"attachments":[]},{"id":7,"commenterId":-7699928860083865744,"content":"I think common.flags is the only thing left, and there\u0027s a fight about it. My vague \r\nunderstanding is that different people are in charge of it now, and there\u0027s waffling \r\nabout what they want to do with it, or if they\u0027re even going to open-source it at all \r\nanymore.\r\n\r\nIt\u0027s likely that we will have to swap in a different flags library.\r\n\r\nI\u0027m very sorry about this. I wish there was a standard Java flags solution. The \r\namount of hassle the flags library is causing me is disproportional to how important \r\nit is to the rest of the code.","timestamp":1265918775,"attachments":[]},{"id":8,"commenterId":-189835140468615108,"content":"Yes, I also don\u0027t see the flags library as that important/complex. I\u0027m already in the\r\nprocess of removing its usage and stubbing out enough to get the code to run.\r\n\r\nBut it\u0027s not just the flags code missing, com.google.common.base.StringUtil and\r\ncom.google.common.base.Tracer are on my top list of compiler error. Of course, Tracer\r\ndoesn\u0027t seem important so that code is easy to remove. I don\u0027t know what StringUtil\r\ndoes but I haven\u0027t actually looked that much.\r\n","timestamp":1265919821,"attachments":[]},{"id":9,"commenterId":-7699928860083865744,"content":"Neither of those are complicated classes. The Guava people told me months ago that they \r\nwill be open-sourced \"asap\". I\u0027ve since lost faith in their definition of \"soon\". :(\r\n\r\n(I don\u0027t actively look at what\u0027s in their public repository; I just look at their \r\nprivate one.)\r\n\r\nI\u0027ll see if I can get StringUtil and Tracer out today. flags may be a bit more messy...","timestamp":1265920708,"attachments":[]},{"id":10,"commenterId":-7699928860083865744,"content":"This issue was closed by revision r128.","timestamp":1267839220,"attachments":[]}]}