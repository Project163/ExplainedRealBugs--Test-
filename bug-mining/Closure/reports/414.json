{"id":22,"status":"Verified","summary":"Works using closure-compiler.appspot.com, fails using compiler.jar (Variable $ first declared...)","labels":["Type-Defect","Priority-Critical"],"stars":8,"commentCount":10,"comments":[{"id":0,"commenterId":5596694112720880762,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n\r\n1. Feed the JavaScript at https://wincent.com/javascripts/ajax.max.js into the compiler at \r\nhttp://closure-compiler.appspot.com/ (either by pasting in the JS itself, or the URL to it)\r\n2. Click compile and observe results\r\n3. Now feed the same JavaScript into the command-line compiler (java -jar compiler.jar --\r\njs\u003dajax.max.js  --js_output_file\u003dajax.min.js) and observe the results\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\n\r\nExpected to see the same output for both online compiler and the compiler one.\r\n\r\nInstead see:\r\n\r\n1. Correctly compiled output for the online compiler with no errors or warnings.\r\n2. For the command-line compiler get a zero-byte output file and see:\r\n\r\n  {SyntheticVarsDeclar}: ERROR - Variable $ first declared in {SyntheticVarsDeclar}\r\n\r\n  1 error(s), 0 warning(s)\r\n\r\nAs the compiler doesn\u0027t include any line or column information with this error it is a bit difficult \r\nto know why it is choking.\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\n\r\nDownloaded \u0026quot;compiler-latest.zip\u0026quot; on 9 November 2009, which I suppose corresponds to \r\ncompiler-20091106b.zip.\r\n\r\nThis is on Mac OS X 10.6.1; first few lines of \u0026quot;java -showversion\u0026quot; output:\r\n\r\n  java version \u0026quot;1.6.0_15\u0026quot;\r\n  Java(TM) SE Runtime Environment (build 1.6.0_15-b03-219)\r\n  Java HotSpot(TM) Client VM (build 14.1-b02-90, mixed mode)\r\n\r\nI get similar results (success with the online compiler, failure with the command-line compiler) \r\nfor other inputs:\r\n\r\nhttps://wincent.com/javascripts/application.max.js\r\nhttps://wincent.com/javascripts/products.max.js\r\n\r\nCan only get trivial examples to work with command-line compiler.","timestamp":1257790331,"attachments":[]},{"id":1,"commenterId":1914560410833080530,"content":"I have the same kind of errors trying to compile last version of jquery. I\u0027m using\r\ncompiler-20091106b. The errors are the same for normal and avanced compilation, this\r\nis the outut:\r\n\r\n\r\njquery-1.3.2.js:988: WARNING - Suspicious code. This code lacks side-effects. Is\r\nthere a bug?\r\n\t\t\tif ( name \u003d\u003d \"selected\" \u0026\u0026 elem.parentNode )\r\n\t\t\t^\r\n\r\njquery-1.3.2.js:989: WARNING - Suspicious code. This code lacks side-effects. Is\r\nthere a bug?\r\n\t\t\t\telem.parentNode.selectedIndex;\r\n\t\t\t\t^\r\n\r\njquery-1.3.2.js:1866: WARNING - Suspicious code. This code lacks side-effects. Is\r\nthere a bug?\r\n\t\t\telem.parentNode.selectedIndex;\r\n\t\t\t^\r\n\r\n{SyntheticVarsDeclar}: ERROR - Variable clearInterval first declared in\r\n{SyntheticVarsDeclar}\r\n\r\n{SyntheticVarsDeclar}: ERROR - Variable hasDuplicate first declared in\r\n{SyntheticVarsDeclar}\r\n\r\n{SyntheticVarsDeclar}: ERROR - Variable setInterval first declared in\r\n{SyntheticVarsDeclar}\r\n\r\n{SyntheticVarsDeclar}: ERROR - Variable setTimeout first declared in\r\n{SyntheticVarsDeclar}\r\n\r\n4 error(s), 3 warning(s)","timestamp":1257791188,"attachments":[]},{"id":2,"commenterId":-7699928860083865744,"content":"","timestamp":1257792890,"attachments":[]},{"id":3,"commenterId":-5457419892787347509,"content":"Same effect with latest jQuery (1.3.2) and closure-compiler checked out from SVN. ","timestamp":1257843084,"attachments":[]},{"id":4,"commenterId":-5457419892787347509,"content":"Also there is a problem compiling latest MooTools (1.2.4) with both the compiler-latest and SVN version.\r\n\r\nThe output is as follows:\r\nmootools-1.2.4-core-nc.js:572: WARNING - Suspicious code. This code lacks side-effects. Is there a bug?\r\n\t\tfor (var i \u003d this.length; i--; i){\r\n\t\t                               ^\r\n\r\nmootools-1.2.4-core-nc.js:1367: WARNING - Suspicious code. This code lacks side-effects. Is there a bug?\r\n\t\t\tfor (var i \u003d fns.length; i--; i) this.removeEvent(type, fns[i]);\r\n\t\t\t                              ^\r\n\r\nmootools-1.2.4-core-nc.js:2802: WARNING - Suspicious code. This code lacks side-effects. Is there a bug?\r\n\t\t\tfor (i \u003d parsed.classes.length; i--; i){\r\n\t\t\t                                     ^\r\n\r\nmootools-1.2.4-core-nc.js:2808: WARNING - Suspicious code. This code lacks side-effects. Is there a bug?\r\n\t\t\tfor (i \u003d parsed.attributes.length; i--; i){\r\n\t\t\t                                        ^\r\n\r\nmootools-1.2.4-core-nc.js:2814: WARNING - Suspicious code. This code lacks side-effects. Is there a bug?\r\n\t\t\tfor (i \u003d parsed.pseudos.length; i--; i){\r\n\t\t\t                                     ^\r\n\r\nmootools-1.2.4-core-nc.js:406: ERROR - Variable Window first declared in ie_dom.js\r\nvar Window \u003d new Native({\r\n^\r\n\r\nmootools-1.2.4-core-nc.js:433: ERROR - Variable Document first declared in w3c_dom1.js\r\nvar Document \u003d new Native({\r\n^\r\n\r\nmootools-1.2.4-core-nc.js:1008: ERROR - Variable Event first declared in w3c_event.js\r\nvar Event \u003d new Native({\r\n^\r\n\r\nmootools-1.2.4-core-nc.js:1419: ERROR - Variable Element first declared in w3c_dom1.js\r\nvar Element \u003d new Native({\r\n^\r\n\r\n4 error(s), 5 warning(s)\r\n","timestamp":1257843963,"attachments":[]},{"id":5,"commenterId":-7699928860083865744,"content":"fixed in the 11/10 jar","timestamp":1257887058,"attachments":[]},{"id":6,"commenterId":5596694112720880762,"content":"Confirmed that the 11/10 jar doesn\u0027t choke on those files any more.\r\n\r\nThanks for the fix.","timestamp":1257891470,"attachments":[]},{"id":7,"commenterId":-5060162230523776870,"content":"","timestamp":1257984531,"attachments":[]},{"id":8,"commenterId":1914560410833080530,"content":"It works for me now also thanks!","timestamp":1258111392,"attachments":[]},{"id":9,"commenterId":-5457419892787347509,"content":"The question is whether jQuery works after compiling it with the compiler?\r\nFor me it doesn\u0027t as $ function is broken and doesn\u0027t return HTML Element wrapped inside jQuery object.\r\n\r\nPlus MooTools compilation is still broken (same errors as above).\r\nI\u0027ve been using the latest version from SVN.","timestamp":1258378468,"attachments":[]}]}