{"id":1032,"status":"Fixed","summary":"Advanced optimizations removes instanceof check","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":4,"comments":[{"id":0,"commenterId":632593088416531741,"content":"Given the following input:\r\n\r\nif (propEvt instanceof window.MouseEvent) propEvt.preventDefault();\r\nif (globalEvt instanceof MouseEvent) globalEvt.preventDefault();\r\n\r\n$ closure --compilation_level ADVANCED_OPTIMIZATIONS mouseeventtest.js\r\nglobalEvt instanceof MouseEvent\u0026amp;\u0026amp;globalEvt.preventDefault();\r\n\r\nThe same happens with any property on window, unless it has been accessed or set before. So a simple if (window.MouseEvent) ... in the beginning of the file will prevent the propEvt line from being optimized away.\r\n\r\nI\u0027m not sure if this is a feature, but in that case it is an unexpected one.","timestamp":1372066712,"attachments":[]},{"id":1,"commenterId":-5060162230523776870,"content":"I\u0027m not sure what pass is doing this but without a definition for window.MouseEvent, something is assuming the expression is false.  Adding a definition for \"window.MouseEvent\" in the externs should be sufficient to fix this, if this is the case.","timestamp":1372087584,"attachments":[]},{"id":2,"commenterId":-7699928860083865744,"content":"I posted a fix for this here:\r\nhttps://codereview.appspot.com/21460043/","timestamp":1383520491,"attachments":[]},{"id":3,"commenterId":-7699928860083865744,"content":"This issue was closed by revision 7de691d40240.","timestamp":1392901029,"attachments":[]}]}