{"id":16,"status":"Fixed","summary":"MinimizeExitPoints does not properly hoist function definitions.","labels":["Type-Defect","Priority-Medium"],"stars":2,"commentCount":8,"comments":[{"id":0,"commenterId":-2383702226191207389,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n1. Start with this code snippet:\r\nfunction a(b) {\r\n  if (b) {\r\n    c()\r\n    return undefined\r\n  }\r\n  function c(){}\r\n}\r\na(1)\r\n\r\n2. Observe that it runs without error in Firefox 3.5.5\r\n3. Compile the snippet with either simple or advanced optimizations\r\n4. Observe that you get the following output:\r\nfunction a(b){if(b)c();else{function c(){}}}a(1);\r\n\r\n5. Run the output code in Firefox 3.5.5\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\n\r\nExpected output: code without errors will compile into code that does not \r\nraise errors\r\n\r\nInstead I get the error: \u0026quot;c is not defined\u0026quot;\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\n\r\nTested with version 20091103 in Firefox 3.5.5 on Snow Leopard.  The \r\noutputted code also fails with Rhino 1.7 release 2 2009 03 22.\r\n\r\nChrome (Mac Dev 4.0.223.11) and Safari (4.0.3) execute the outputted \r\ncode without error.\r\n\r\n\u003cb\u003ePlease provide any additional information below.\u003c/b\u003e\n\r\nThis is a reduced test case extracted from the ajax method of jQuery 1.3.2","timestamp":1257637772,"attachments":[]},{"id":1,"commenterId":-2383702226191207389,"content":"This error is also present in 20091106b","timestamp":1257638904,"attachments":[]},{"id":2,"commenterId":-5060162230523776870,"content":"It should either move the function definition to the top of the function block or leave \r\nit at the bottom, but it should not move it into the else condition.","timestamp":1257662846,"attachments":[]},{"id":3,"commenterId":-5060162230523776870,"content":"","timestamp":1257662891,"attachments":[]},{"id":4,"commenterId":-5060162230523776870,"content":"Fixed, pending integration","timestamp":1258160190,"attachments":[]},{"id":5,"commenterId":-7699928860083865744,"content":"Fixed in the command-line tool. pending integration into the web service.","timestamp":1258161455,"attachments":[]},{"id":6,"commenterId":-2383702226191207389,"content":"Verified that this issue (and the jquery code that spawned it) is fixed and working correctly on the command-line in \r\ntoday\u0027s updated jar.","timestamp":1258162203,"attachments":[]},{"id":7,"commenterId":-5060162230523776870,"content":"The webservice has been updated.","timestamp":1258413092,"attachments":[]}]}