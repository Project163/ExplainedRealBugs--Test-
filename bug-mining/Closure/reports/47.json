{"id":221,"status":"Fixed","summary":"jscomp Ant Task (CompileTask) Does Not Fail Build on Failed JS Compilation","labels":["Type-Defect","Priority-High"],"stars":2,"commentCount":6,"comments":[{"id":0,"commenterId":-7500875020965168863,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n\r\n1. Using the Closure Compiler Ant task provided by com.google.javascript.jscomp.ant.CompileTask, I noticed that it does not fail a build in the event that an error occurs with compilation.  Even if the JavaScript resource I\u0027m attempting to compile contains blatant syntax errors, Ant claims the CompileTask was successful and continues with the build even though the Closure compiler encountered an error ...\r\n\r\nBuildfile: /opt/eclipse-workspace/jscomp-fails/build.xml\r\ncompile:\r\n   [jscomp] Compiling 1 file(s) with 36 extern(s)\r\n   [jscomp] /opt/eclipse-workspace/jscomp-fails/dumb.js:3: ERROR - Parse error. syntax error\r\n   [jscomp] if(a\u003d)jjj\r\n   [jscomp]       ^\r\n   [jscomp] 1 error(s), 0 warning(s)\r\nBUILD SUCCESSFUL\r\nTotal time: 1 second\r\n\r\nNote the \u0026quot;BUILD SUCCESSFUL\u0026quot; here.  Seems silly to want the build to continue if your JavaScript fails to compile.\r\n\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\n\r\nI would expect CompileTask to throw a BuildException if the compilation failed for any reason (e.g., if((result \u003d compiler.compile(...)) !\u003d success)).  This halts the build process at the target that generated the error and lets me fix my JavaScript before I continue.\r\n\r\nWith a proper fix in place (throwing a BuildException on failure) a compilation error would look like this ...\r\n\r\nBuildfile: /opt/eclipse-workspace/jscomp-fails/build.xml\r\ncompile:\r\n   [jscomp] Compiling 1 file(s) with 36 extern(s)\r\n   [jscomp] /opt/eclipse-workspace/jscomp-fails/dumb.js:3: ERROR - Parse error. syntax error\r\n   [jscomp] if(a\u003d)jjj\r\n   [jscomp]       ^\r\n   [jscomp] 1 error(s), 0 warning(s)\r\n\r\nBUILD FAILED\r\n/opt/eclipse-workspace/jscomp-fails/build.xml:9: Compilation failed.\r\n\r\nNote the \u0026quot;BUILD FAILED\u0026quot; here.\r\n\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\n\r\nTop of trunk, SVN rev 361.\r\n\r\n\r\n\u003cb\u003ePlease provide any additional information below.\u003c/b\u003e\n\r\nPossible patch suggestion is attached.","timestamp":1281804276,"attachments":[{"id":-5531138195452717899,"fileName":"compile-task-throw-buildexception.diff","fileSize":518}]},{"id":1,"commenterId":-5060162230523776870,"content":"","timestamp":1281990421,"attachments":[]},{"id":2,"commenterId":-7699928860083865744,"content":"Ideally, we\u0027d like you to sign a CLA so that we can accept patches from you in the future. A CLA basically says that you own this code, and that you are giving us permission to use it. See:\r\nhttp://code.google.com/p/closure-compiler/source/browse/trunk/CONTRIBUTORS\r\n\r\nHowever, this is a small change. Dan, can we accept this without a CLA?","timestamp":1282147598,"attachments":[]},{"id":3,"commenterId":-4134745362790715362,"content":"Do it","timestamp":1282147804,"attachments":[]},{"id":4,"commenterId":-7699928860083865744,"content":"This issue was closed by revision r367.","timestamp":1282165318,"attachments":[]},{"id":5,"commenterId":-7500875020965168863,"content":"Fix verified with rev 374; it\u0027s working great. Thanks!","timestamp":1282337874,"attachments":[]}]}