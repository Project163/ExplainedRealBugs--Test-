{"id":598,"status":"Fixed","summary":"\"already defined in this object literal\" parse error when using ES5 getter \u0026 setter with same prop name (in strict mode only?)","labels":["Type-Defect","Priority-Medium"],"stars":0,"commentCount":9,"comments":[{"id":0,"commenterId":-2580782774957019135,"content":"\u003cb\u003eWhat steps will reproduce the problem?\u003c/b\u003e\n\r\nclosurecompiler --language_in ECMASCRIPT5_STRICT --compilation_level ADVANCED_OPTIMIZATIONS \u0026lt;\u0026lt;EOT\r\n\u0027use strict\u0027;\r\nfunction App() {}\r\nApp.prototype \u003d {\r\n  get appData() { return this.appData_; },\r\n  set appData(data) { this.appData_ \u003d data; }\r\n};\r\nEOT\r\n\r\n\u003cb\u003eWhat is the expected output? What do you see instead?\u003c/b\u003e\nI expect no errors.  Instead I see:\r\n\r\nstdin:5: ERROR - Parse error. Property \u0026quot;appData\u0026quot; already defined in this object literal.\r\n  set appData(data) { this.appData_ \u003d data; }\r\n                                             ^\r\n\r\n1 error(s), 0 warning(s)\r\n\r\n\r\n\u003cb\u003eWhat version of the product are you using? On what operating system?\u003c/b\u003e\n\r\nVersion: 1346\r\nBuilt on: 2011/08/11 15:02,\r\n\r\n[G]Ubuntu 10.04.2 LTS\r\n\r\n\r\n\u003cb\u003ePlease provide any additional information below.\u003c/b\u003e\nHappens only when using string literal \u0027use strict\u0027; to trigger strict mode.\r\n\r\nNOTE: I think there\u0027s a second bug here, as when you run `closurecompiler --version` I expect it to spit out a version and not go into stdin compilation mode, but it continues to wait for stdin.  Perhaps this is a feature, though?","timestamp":1321471894,"attachments":[]},{"id":1,"commenterId":-5060162230523776870,"content":"Thanks for the report.","timestamp":1321487602,"attachments":[]},{"id":2,"commenterId":-5060162230523776870,"content":"I can\u0027t reproduce this with the latest build.","timestamp":1321492313,"attachments":[]},{"id":3,"commenterId":-5501277457847558818,"content":"still happening for me on r1459:\r\n\r\n\r\n$ ./compiler.jar --language_in ECMASCRIPT5_STRICT --compilation_level ADVANCED_OPTIMIZATIONS \u003c\u003cEOT\r\n\u0027use strict\u0027;\r\nfunction App() {}\r\nApp.prototype \u003d {\r\n  get appData() { return this.appData_; },\r\n  set appData(data) { this.appData_ \u003d data; }\r\n};\r\nEOT\r\n\r\nstdin:5: ERROR - Parse error. Property \"appData\" already defined in this object literal.\r\n  set appData(data) { this.appData_ \u003d data; }\r\n                                             ^\r\n\r\n1 error(s), 0 warning(s)\r\n\r\n\r\n$ ./compiler.jar --version\r\nClosure Compiler (http://code.google.com/closure/compiler)\r\nVersion: 20111003 (revision 1459)\r\nBuilt on: 2011/10/03 11:29\r\n","timestamp":1321495182,"attachments":[]},{"id":4,"commenterId":-5060162230523776870,"content":"I reproduced this. It appears to be a rhino parser bug.  You can work around the problem by removing the \"use strict\" from the input source.  The source will still be checked by the compiler but no by rhino.","timestamp":1321897475,"attachments":[]},{"id":5,"commenterId":-2580782774957019135,"content":"\u003e You can work around the problem by removing the \"use strict\" from the input source.\r\n\r\nYup, I put that in the additional information.\r\n\r\n\u003crant\u003e\r\nI thought the point of \u0027use strict\u0027; as a string literal is that it\u0027s just a no-op statement that works backward compatibly, lol, but I guess not *all* the time.\r\n\u003c/rant\u003e\r\n\r\nI just imagine putting \u0027use strict\u0027; at the top of a file or inside a function is a relatively common use case for those wanting to use ES5 strict mode, no?  For instance, we do something like this:\r\n\r\n  cr.define(\u0027ntp4\u0027, function() {\r\n    \u0027use strict\u0027;\r\n    // strict mode scoped per module\r\n  });\r\n\r\nall over the New Tab page in Chrom{e,ium}.  This bug was derived by trying to run the compiler on our code (http://goo.gl/zDQyw) as a @return type enforcer to prevent bugs.  I imagine we\u0027d like to continue using strict mode.  Your workaround is great for reading via closure compiler, but we\u0027d have to find some other way of signalling to Chrom{e,ium} to use ES5 strict mode, which is kinda lame or do some egrep -v [\\\u0027\\\"]use\\ strict[\\\u0027\\\"] hack before we run the closure compiler.","timestamp":1321905042,"attachments":[]},{"id":6,"commenterId":-7699928860083865744,"content":"To be clear, this will get fixed soon. John was just suggesting an immediate solution if you needed it.","timestamp":1321907357,"attachments":[]},{"id":7,"commenterId":1328304962299559429,"content":"This issue was closed by revision r1628.","timestamp":1321923639,"attachments":[]},{"id":8,"commenterId":-2580782774957019135,"content":"Awesome!  Thanks for the quick turn around!","timestamp":1321923921,"attachments":[]}]}