diff --git a/src/com/google/javascript/jscomp/AbstractCommandLineRunner.java b/src/com/google/javascript/jscomp/AbstractCommandLineRunner.java
index aed750395..3a032bd32 100644
--- a/src/com/google/javascript/jscomp/AbstractCommandLineRunner.java
+++ b/src/com/google/javascript/jscomp/AbstractCommandLineRunner.java
@@ -368,8 +368,6 @@ abstract class AbstractCommandLineRunner<A extends Compiler,
           throw new FlagUsageException("Can't specify stdin twice.");
         }
 
-        inputs.add(JSSourceFile.fromInputStream("stdin", System.in));
-        usingStdin = true;
         if (!config.outputManifests.isEmpty()) {
           throw new FlagUsageException("Manifest files cannot be generated " +
               "when the input is from stdin.");
@@ -378,6 +376,8 @@ abstract class AbstractCommandLineRunner<A extends Compiler,
           throw new FlagUsageException("Bundle files cannot be generated " +
               "when the input is from stdin.");
         }
+        inputs.add(JSSourceFile.fromInputStream("stdin", System.in));
+        usingStdin = true;
       }
     }
     return inputs;
@@ -1689,9 +1689,16 @@ abstract class AbstractCommandLineRunner<A extends Compiler,
 
     /**
      * Sets whether to print output manifest files.
+     * Filter out empty file names.
      */
     CommandLineConfig setOutputManifest(List<String> outputManifests) {
-      this.outputManifests = outputManifests;
+      this.outputManifests = Lists.newArrayList();
+      for (String manifestName : outputManifests) {
+        if (!manifestName.isEmpty()) {
+          this.outputManifests.add(manifestName);
+        }
+      }
+      this.outputManifests = ImmutableList.copyOf(this.outputManifests);
       return this;
     }
 
diff --git a/test/com/google/javascript/jscomp/CommandLineRunnerTest.java b/test/com/google/javascript/jscomp/CommandLineRunnerTest.java
index 32fd8411f..5a4980ed6 100644
--- a/test/com/google/javascript/jscomp/CommandLineRunnerTest.java
+++ b/test/com/google/javascript/jscomp/CommandLineRunnerTest.java
@@ -23,12 +23,14 @@ import com.google.common.base.Supplier;
 import com.google.common.base.Suppliers;
 import com.google.common.collect.ImmutableList;
 import com.google.common.collect.Lists;
+import com.google.javascript.jscomp.AbstractCommandLineRunner.FlagUsageException;
 import com.google.javascript.jscomp.CompilerOptions.LanguageMode;
 import com.google.javascript.rhino.Node;
 
 import junit.framework.TestCase;
 
 import java.io.ByteArrayOutputStream;
+import java.io.IOException;
 import java.io.PrintStream;
 import java.util.List;
 
@@ -834,6 +836,20 @@ public class CommandLineRunnerTest extends TestCase {
     testSame("var x = {}; with (x) {}");
   }
 
+  public void testNoSrCFilesWithManifest() throws IOException {
+    args.add("--use_only_custom_externs=true");
+    args.add("--output_manifest=test.MF");
+    CommandLineRunner runner = createCommandLineRunner(new String[0]);
+    String expectedMessage = "";
+    try {
+      runner.doRun();
+    } catch (FlagUsageException e) {
+      expectedMessage = e.getMessage();
+    }
+    assertEquals(expectedMessage, "Bad --js flag. " +
+      "Manifest files cannot be generated when the input is from stdin.");
+  }
+
   /* Helper functions */
 
   private void testSame(String original) {
