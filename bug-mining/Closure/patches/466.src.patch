diff --git a/src/com/google/javascript/jscomp/ExternExportsPass.java b/src/com/google/javascript/jscomp/ExternExportsPass.java
index e7a1e8eee..efb1cbdfe 100644
--- a/src/com/google/javascript/jscomp/ExternExportsPass.java
+++ b/src/com/google/javascript/jscomp/ExternExportsPass.java
@@ -127,7 +127,7 @@ final class ExternExportsPass extends NodeTraversal.AbstractPostOrderCallback
 
         if (valueToExport != null) {
           JSDocInfo jsdoc = NodeUtil.getBestJSDocInfo(valueToExport);
-          if (jsdoc != null && jsdoc.containsTypeDefinition()) {
+          if (valueToExport.isClass() || (jsdoc != null && jsdoc.containsTypeDefinition())) {
             exportedValueDefinesNewType = true;
           }
         }
@@ -569,8 +569,10 @@ final class ExternExportsPass extends NodeTraversal.AbstractPostOrderCallback
     } else if (n.isAssign()) {
       // TODO(b/123718645): Add support for destructuring assignments
       Node lhs = n.getFirstChild();
-      if (lhs.isQualifiedName()) {
+      if (lhs.isQualifiedName() && (!lhs.hasChildren() || !lhs.getFirstChild().isThis())) {
         // qualified.name = value;
+        //   but not
+        // this.prop = value;
         definitionMap.put(lhs.getQualifiedName(), n.getLastChild());
       }
     } else if (n.isName()) {
diff --git a/test/com/google/javascript/jscomp/ExternExportsPassTest.java b/test/com/google/javascript/jscomp/ExternExportsPassTest.java
index cd18f7774..ef8da3ff8 100644
--- a/test/com/google/javascript/jscomp/ExternExportsPassTest.java
+++ b/test/com/google/javascript/jscomp/ExternExportsPassTest.java
@@ -418,8 +418,16 @@ public final class ExternExportsPassTest extends CompilerTestCase {
             "};",
             "goog.exportProperty(a.b, 'cprop', a.b.c)"),
         lines(
-            "var a;",
-            "a.b;",
+            "/**",
+            " * @const",
+            " * @suppress {const,duplicate}",
+            " */",
+            "var a = {};",
+            "/**",
+            " * @const",
+            " * @suppress {const,duplicate}",
+            " */",
+            "a.b = {};",
             "/**",
             " * @param {?} d",
             " * @param {?} e",
@@ -486,7 +494,11 @@ public final class ExternExportsPassTest extends CompilerTestCase {
             "goog.exportProperty(a.b, 'c', a.b.c);",
             "goog.exportProperty(a.b.prototype, 'c', a.b.prototype.c);"),
         lines(
-            "var a;",
+            "/**",
+            " * @const",
+            " * @suppress {const,duplicate}",
+            " */",
+            "var a = {};",
             "/**",
             " * @param {?} p1",
             " * @constructor",
@@ -1574,17 +1586,12 @@ public final class ExternExportsPassTest extends CompilerTestCase {
             "function F() { /** @export */ this.x = function(/** string */ x){};}",
             "goog.exportSymbol('F', F);"),
         lines(
-            "/**",
+            "/**", //
             " * @constructor",
             " */",
             "var F = function() {",
             "};",
-            "/**",
-            " * @param {string} x",
-            " * @return {undefined}",
-            " */",
-            "F.prototype.x = function(x) {",
-            "};",
+            "F.prototype.x;",
             ""));
   }
 
