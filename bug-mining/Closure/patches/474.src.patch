diff --git a/src/com/google/javascript/jscomp/CheckSideEffects.java b/src/com/google/javascript/jscomp/CheckSideEffects.java
index 6996a2eee..3ad45ccea 100644
--- a/src/com/google/javascript/jscomp/CheckSideEffects.java
+++ b/src/com/google/javascript/jscomp/CheckSideEffects.java
@@ -130,7 +130,7 @@ final class CheckSideEffects extends AbstractPostOrderCallback implements Compil
 
     boolean isResultUsed = NodeUtil.isExpressionResultUsed(n);
     boolean isSimpleOp = NodeUtil.isSimpleOperator(n) || n.isGetProp() || n.isGetElem();
-    if (!isResultUsed) {
+    if (!isResultUsed && !n.isVoid()) {
       if (isSimpleOp || !t.getCompiler().getAstAnalyzer().mayHaveSideEffects(n)) {
         if (report) {
           String msg = "This code lacks side-effects. Is there a bug?";
diff --git a/test/com/google/javascript/jscomp/CheckSideEffectsTest.java b/test/com/google/javascript/jscomp/CheckSideEffectsTest.java
index 0d87154a5..555ba70d3 100644
--- a/test/com/google/javascript/jscomp/CheckSideEffectsTest.java
+++ b/test/com/google/javascript/jscomp/CheckSideEffectsTest.java
@@ -164,12 +164,12 @@ public final class CheckSideEffectsTest extends CompilerTestCase {
     testSame("for(; true; ) { bar() }");
     testSame("for(foo(); true; foo()) { bar() }");
     test(
-        "for(void 0; true; foo()) { bar() }",
-        "for(JSCOMPILER_PRESERVE(void 0); true; foo()) { bar() }",
+        "for(i < 5; true; foo()) { bar() }",
+        "for(JSCOMPILER_PRESERVE(i < 5); true; foo()) { bar() }",
         warning(e));
     test(
-        "for(foo(); true; void 0) { bar() }",
-        "for(foo(); true; JSCOMPILER_PRESERVE(void 0)) { bar() }",
+        "for(var i = foo(); i++; i < 5) { bar() }",
+        "for(var i = foo(); i++; JSCOMPILER_PRESERVE(i < 5)) { bar() }",
         warning(e));
     test(
         "for(foo(); true; (1, bar())) { bar() }",
@@ -288,11 +288,14 @@ public final class CheckSideEffectsTest extends CompilerTestCase {
 
   @Test
   public void testIssue504() {
+    // See https://blickly.github.io/closure-compiler-issues/#504, though the `void` idiom in the
+    // original issue is still relevant externally (see ESLint's ignoreVoid option for the
+    // no-floating-promises rule), so it's no longer an error.
     test(
-        "void f();",
-        "JSCOMPILER_PRESERVE(void f());",
+        "+f();",
+        "JSCOMPILER_PRESERVE(+f());",
         warning(e)
-            .withMessage("Suspicious code. The result of the 'void' operator is not being used."));
+            .withMessage("Suspicious code. The result of the 'pos' operator is not being used."));
   }
 
   @Test
diff --git a/test/com/google/javascript/jscomp/CommandLineRunnerTest.java b/test/com/google/javascript/jscomp/CommandLineRunnerTest.java
index cf7887e13..dddcded1d 100644
--- a/test/com/google/javascript/jscomp/CommandLineRunnerTest.java
+++ b/test/com/google/javascript/jscomp/CommandLineRunnerTest.java
@@ -956,9 +956,8 @@ public final class CommandLineRunnerTest {
   public void testIssue504() {
     args.add("--compilation_level=ADVANCED_OPTIMIZATIONS");
     test(
-        "void function() { alert('hi'); }();",
-        "alert('hi');void 0",
-        CheckSideEffects.USELESS_CODE_ERROR);
+        "void function() { alert('hi'); }();", //
+        "alert('hi');");
   }
 
   @Test
