diff --git a/src/com/google/javascript/jscomp/CompilerInput.java b/src/com/google/javascript/jscomp/CompilerInput.java
index 557da5199..087f6b802 100644
--- a/src/com/google/javascript/jscomp/CompilerInput.java
+++ b/src/com/google/javascript/jscomp/CompilerInput.java
@@ -290,9 +290,10 @@ public class CompilerInput extends DependencyInfo.Base implements SourceAst {
       // symbol dependencies.)
       try {
         DependencyInfo info =
-            (new JsFileParser(compiler.getErrorManager()))
-            .setIncludeGoogBase(true)
-            .parseFile(getName(), getName(), getCode());
+            new JsFileParser(compiler.getErrorManager())
+                .setModuleLoader(compiler.getModuleLoader())
+                .setIncludeGoogBase(true)
+                .parseFile(getName(), getName(), getCode());
         return new LazyParsedDependencyInfo(info, (JsAst) ast, compiler);
       } catch (IOException e) {
         compiler.getErrorManager().report(CheckLevel.ERROR,
diff --git a/src/com/google/javascript/jscomp/deps/JsFileParser.java b/src/com/google/javascript/jscomp/deps/JsFileParser.java
index a50ff9a68..a0aff1b61 100644
--- a/src/com/google/javascript/jscomp/deps/JsFileParser.java
+++ b/src/com/google/javascript/jscomp/deps/JsFileParser.java
@@ -325,7 +325,10 @@ public final class JsFileParser extends JsFileLineParser {
             // cut off the "goog:" prefix
             requires.add(Require.googRequireSymbol(arg.substring(5)));
           } else {
-            ModuleLoader.ModulePath path = file.resolveModuleAsPath(arg);
+            ModuleLoader.ModulePath path = file.resolveJsModule(arg);
+            if (path == null) {
+              path = file.resolveModuleAsPath(arg);
+            }
             requires.add(Require.es6Import(path.toModuleName(), arg));
           }
         }
diff --git a/src/com/google/javascript/jscomp/gwt/super/com/google/javascript/jscomp/deps/JsFileParser.java b/src/com/google/javascript/jscomp/gwt/super/com/google/javascript/jscomp/deps/JsFileParser.java
index 9d6f1edd9..633f032cc 100644
--- a/src/com/google/javascript/jscomp/gwt/super/com/google/javascript/jscomp/deps/JsFileParser.java
+++ b/src/com/google/javascript/jscomp/gwt/super/com/google/javascript/jscomp/deps/JsFileParser.java
@@ -23,6 +23,10 @@ public final class JsFileParser {
   public JsFileParser(ErrorManager errorManager) {
   }
 
+  public JsFileParser setModuleLoader(ModuleLoader loader) {
+    throw new UnsupportedOperationException("JsFileParser.setModuleLoader not implemented");
+  }
+
   public JsFileParser setIncludeGoogBase(boolean include) {
     throw new UnsupportedOperationException("JsFileParser.setIncludeGoogBase not implemented");
   }
