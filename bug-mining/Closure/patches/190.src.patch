diff --git a/src/com/google/javascript/jscomp/Compiler.java b/src/com/google/javascript/jscomp/Compiler.java
index 4ff23f710..dca98d99a 100644
--- a/src/com/google/javascript/jscomp/Compiler.java
+++ b/src/com/google/javascript/jscomp/Compiler.java
@@ -1387,7 +1387,7 @@ public class Compiler extends AbstractCompiler {
    * process and creates JSModules and the corresponding dependency tree
    * on the way.
    */
-  private void processAMDAndCommonJSModules() {
+  void processAMDAndCommonJSModules() {
     Map<String, JSModule> modulesByName = Maps.newLinkedHashMap();
     Map<CompilerInput, JSModule> modulesByInput = Maps.newLinkedHashMap();
     // TODO(nicksantos): Refactor module dependency resolution to work nicely
@@ -1423,7 +1423,12 @@ public class Compiler extends AbstractCompiler {
       for (JSModule module : modules) {
         for (CompilerInput input : module.getInputs()) {
           for (String require : input.getRequires()) {
-            module.addDependency(modulesByName.get(require));
+            JSModule dependency = modulesByName.get(require);
+            if (dependency == null) {
+              report(JSError.make(MISSING_ENTRY_ERROR, require));
+            } else {
+              module.addDependency(dependency);
+            }
           }
         }
       }
diff --git a/src/com/google/javascript/jscomp/JSModule.java b/src/com/google/javascript/jscomp/JSModule.java
index b033e61eb..93751c0ec 100644
--- a/src/com/google/javascript/jscomp/JSModule.java
+++ b/src/com/google/javascript/jscomp/JSModule.java
@@ -130,6 +130,7 @@ public class JSModule implements DependencyInfo, Serializable {
 
   /** Adds a dependency on another module. */
   public void addDependency(JSModule dep) {
+    Preconditions.checkNotNull(dep);
     Preconditions.checkState(dep != this);
     deps.add(dep);
   }
diff --git a/test/com/google/javascript/jscomp/CompilerTest.java b/test/com/google/javascript/jscomp/CompilerTest.java
index f9f1ad9e1..e59756c11 100644
--- a/test/com/google/javascript/jscomp/CompilerTest.java
+++ b/test/com/google/javascript/jscomp/CompilerTest.java
@@ -18,8 +18,6 @@ package com.google.javascript.jscomp;
 
 import com.google.common.collect.ImmutableList;
 import com.google.common.collect.Lists;
-import com.google.javascript.jscomp.deps.SortedDependencies.CircularDependencyException;
-import com.google.javascript.jscomp.deps.SortedDependencies.MissingProvideException;
 import com.google.javascript.rhino.Node;
 
 import junit.framework.TestCase;
@@ -112,21 +110,14 @@ public class CompilerTest extends TestCase {
     compiler.compile(externs, input, options);
   }
 
-  public void testCommonJSProvidesAndRequire() throws
-      CircularDependencyException, MissingProvideException {
+  public void testCommonJSProvidesAndRequire() throws Exception {
     List<SourceFile> inputs = Lists.newArrayList(
         SourceFile.fromCode("gin.js", "require('tonic')"),
         SourceFile.fromCode("tonic.js", ""),
         SourceFile.fromCode("mix.js", "require('gin'); require('tonic');"));
-    CompilerOptions options = new CompilerOptions();
-    options.ideMode = true;
     List<String> entryPoints = Lists.newArrayList("module$mix");
-    options.setManageClosureDependencies(entryPoints);
-    options.closurePass = true;
-    options.processCommonJSModules = true;
-    Compiler compiler = new Compiler();
-    compiler.init(Lists.<SourceFile>newArrayList(), inputs, options);
-    compiler.parseInputs();
+
+    Compiler compiler = initCompilerForCommonJS(inputs, entryPoints);
     JSModuleGraph graph = compiler.getModuleGraph();
     assertEquals(graph.getModuleCount(), 3);
     List<CompilerInput> result = graph.manageDependencies(entryPoints,
@@ -137,4 +128,35 @@ public class CompilerTest extends TestCase {
     assertEquals("gin.js", result.get(3).getName());
     assertEquals("mix.js", result.get(4).getName());
   }
+
+  public void testCommonJSMissingRequire() throws Exception {
+    List<SourceFile> inputs = Lists.newArrayList(
+        SourceFile.fromCode("gin.js", "require('missing')"));
+    Compiler compiler = initCompilerForCommonJS(
+        inputs, ImmutableList.of("module$gin"));
+    compiler.processAMDAndCommonJSModules();
+
+    assertEquals(1, compiler.getErrorManager().getErrorCount());
+    String error = compiler.getErrorManager().getErrors()[0].toString();
+    assertTrue(
+        "Unexpected error: " + error,
+        error.contains(
+            "required entry point \"module$missing\" never provided"));
+  }
+
+  private Compiler initCompilerForCommonJS(
+      List<SourceFile> inputs, List<String> entryPoints)
+      throws Exception {
+    CompilerOptions options = new CompilerOptions();
+    options.ideMode = true;
+    options.setManageClosureDependencies(entryPoints);
+    options.closurePass = true;
+    options.processCommonJSModules = true;
+    Compiler compiler = new Compiler();
+    compiler.init(Lists.<SourceFile>newArrayList(), inputs, options);
+    compiler.parseInputs();
+    return compiler;
+  }
+
+
 }
