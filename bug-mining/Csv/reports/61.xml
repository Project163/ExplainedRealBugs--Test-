<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:43:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CSV-213] CSVParser#iterator()#hasNext() fails</title>
                <link>https://issues.apache.org/jira/browse/CSV-213</link>
                <project id="12313222" key="CSV">Commons CSV</project>
                    <description>&lt;p&gt;Hello,&lt;br/&gt;
with class sample below and attached fail the program fails. Problem is that iterator wrongly computes the records. If hasNext is true then next record should be fetched.&lt;br/&gt;
+ wouldn&apos;t it be better to provide currentRecord also?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; CSVFormat csvFormat =
            CSVFormat.DEFAULT
                    .withDelimiter(&lt;span class=&quot;code-quote&quot;&gt;&apos;;&apos;&lt;/span&gt;)
                    .withFirstRecordAsHeader()
                    .withRecordSeparator(&lt;span class=&quot;code-quote&quot;&gt;&apos;\n&apos;&lt;/span&gt;)
                    .withQuoteMode(QuoteMode.ALL);


    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Optional&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]&amp;gt; createEndChannel(File csvFile) {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (Reader reader = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(csvFile), StandardCharsets.UTF_8);
             CSVParser parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CSVParser(reader, csvFormat)) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (parser.iterator().hasNext()) {
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(parser.getCurrentLineNumber());
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(parser.getRecordNumber());
                &lt;span class=&quot;code-comment&quot;&gt;// get only first record we don&lt;span class=&quot;code-quote&quot;&gt;&apos;t need other&apos;&lt;/span&gt;s
&lt;/span&gt;                CSVRecord firstRecord = parser.iterator().next(); &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; fails
&lt;/span&gt;
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Optional.of(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; adding end channel to csv&quot;&lt;/span&gt;, e);
        }

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Optional.empty();
    }


    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        createEndChannel(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/999751170.patch.csv&quot;&lt;/span&gt;));
        &lt;span class=&quot;code-comment&quot;&gt;//createEndChannel(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/129441.csv&quot;&lt;/span&gt;));
&lt;/span&gt;    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;linux/osx&lt;/p&gt;</environment>
        <key id="13088685">CSV-213</key>
            <summary>CSVParser#iterator()#hasNext() fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lukasvasek">Lukas Vasek</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Jul 2017 09:24:32 +0000</created>
                <updated>Sat, 15 Jun 2019 14:08:57 +0000</updated>
                            <resolved>Sat, 15 Jun 2019 14:08:57 +0000</resolved>
                                    <version>1.4</version>
                                                    <component>Parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16095718" author="garydgregory" created="Fri, 21 Jul 2017 03:28:27 +0000"  >&lt;p&gt;This is normal behavior with the current architecture: The &lt;tt&gt;iterator()&lt;/tt&gt; API presents an object that is backed by data in the &lt;tt&gt;CSVParser&lt;/tt&gt; as the parser is &lt;em&gt;streaming&lt;/em&gt; over the file. The &lt;tt&gt;CSVParser&lt;/tt&gt; is like a forward-only stream.&lt;/p&gt;

&lt;p&gt;When you create a new &lt;tt&gt;Iterator&lt;/tt&gt; you are only created a new view on the same position in the parser&apos;s stream.&lt;/p&gt;

&lt;p&gt;For the behavior you want, you need to open a new &lt;tt&gt;CSVParser&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;You can also abreviate the parser creation like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CSVParser parser = csvFormat.parse(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(csvFile), StandardCharsets.UTF_8));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16500359" author="sharnyk" created="Mon, 4 Jun 2018 15:15:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&#160;the issue is that in current architecture the hasNext() method is unusable, because it cant be used with next() method due to skipping of records&lt;/p&gt;</comment>
                            <comment id="16501926" author="garydgregory" created="Tue, 5 Jun 2018 15:08:11 +0000"  >&lt;p&gt;Now that &lt;a href=&quot;https://issues.apache.org/jira/browse/CSV-224&quot; title=&quot;Some multi-iterator parsing peek sequences incorrectly consume elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CSV-224&quot;&gt;&lt;del&gt;CSV-224&lt;/del&gt;&lt;/a&gt; has been addressed, please try a snapshot build from &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-csv/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-csv/&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16730459" author="xxammuxx" created="Fri, 28 Dec 2018 20:00:43 +0000"  >&lt;p&gt;Works with&#160;commons-csv-1.7-20181217.213125-13.jar&lt;/p&gt;

&lt;p&gt;No longer getting the below error.&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.util.NoSuchElementException: No more CSV records available&lt;br/&gt;
 at org.apache.commons.csv.CSVParser$1.next(CSVParser.java:472)&lt;br/&gt;
 at org.apache.commons.csv.CSVParser$1.next(CSVParser.java:436)&lt;br/&gt;
 at com.somename.CommonsCSVExample.createEndChannel(CommonsCSVExample.java:32)&lt;br/&gt;
 at com.somename.CommonsCSVExample.main(CommonsCSVExample.java:46)&lt;/p&gt;</comment>
                            <comment id="16864700" author="sebb@apache.org" created="Sat, 15 Jun 2019 14:08:57 +0000"  >&lt;p&gt;Reported as fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12878124" name="999751170.patch.csv" size="31" author="lukasvasek" created="Thu, 20 Jul 2017 09:25:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 22 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3hscn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>