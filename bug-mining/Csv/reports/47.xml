<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:43:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CSV-167] Comment line hides next record</title>
                <link>https://issues.apache.org/jira/browse/CSV-167</link>
                <project id="12313222" key="CSV">Commons CSV</project>
                    <description>&lt;p&gt;1. First CSV record after the comment line is not processed at all (record #2 and #7)&lt;br/&gt;
2. Second/Third line after the first comment line are not recognized as comment lines (record #5 and #6)&lt;/p&gt;

&lt;p&gt;See attached example!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12924353">CSV-167</key>
            <summary>Comment line hides next record</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rene.suter">Rene</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Dec 2015 11:41:00 +0000</created>
                <updated>Mon, 9 May 2016 17:48:18 +0000</updated>
                            <resolved>Sun, 31 Jan 2016 13:10:43 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                    <component>Parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15072019" author="garydgregory" created="Sun, 27 Dec 2015 00:03:01 +0000"  >&lt;p&gt;I converted the attached to a simple unit test with revision 1721778.&lt;/p&gt;</comment>
                            <comment id="15106151" author="garydgregory" created="Tue, 19 Jan 2016 02:43:08 +0000"  >&lt;p&gt;Still looking for a patch here...&lt;/p&gt;</comment>
                            <comment id="15123153" author="kinow" created="Fri, 29 Jan 2016 07:48:33 +0000"  >&lt;p&gt;Had a look at this issue, in the code and CSV attached, and also in the unit test provided.&lt;/p&gt;

&lt;p&gt;After debugging the parser, it looks like it may be a feature but not a bug? TL;DR: comments are attached to the next valid CSVRecord; three lines with comments in a CSV file are treated as a single comment by the parser in &lt;span class=&quot;error&quot;&gt;&amp;#91;csv&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;When the parser finds the find comment, it stores its value and looks for the next line, which contains the headers. It generates a CSVRecord with value = author,title,publishDate and comment = &quot;Comment before header,,&quot;&lt;/p&gt;

&lt;p&gt;Then it reads a line with &quot;Dan Simmons,Hyperion,1989&quot; creating a CSVRecord with value = Dan Simmons,Hyperion,1989&lt;/p&gt;

&lt;p&gt;But then it finds another comment. So it stores its values, and looks for the next line, which is another comment. Here, the parser adds the comment to the previous comment with a line feed. And ditto for the next comment. Finally the parser finds a line with text Douglas Adams,&quot;The Hitchhiker&apos;s \&quot;Guide\&quot; to the Galaxy&quot;,1979&quot;, creating a CSV Record with value = &quot;Douglas Adams,&quot;The Hitchhiker&apos;s \&quot;Guide\&quot; to the Galaxy&quot;,1979, and comment = Comment Line 1,,LFComment Line 2,,LFComment Line 3,,&lt;/p&gt;

&lt;p&gt;Finally it finds the line with Douglas John,&quot;The Hitchhiker&apos;s \&quot;Guide\&quot; to the Mars&quot;,1979.&lt;/p&gt;

&lt;p&gt;So I don&apos;t believe it is exactly a bug. The parser simply appends any comment found to the next line, as an attribute of the CSVRecord.&lt;/p&gt;

&lt;p&gt;One note is that if you add a comment to the last line of the file, that comment is discarded, as there won&apos;t be a CSVRecord to attach the comment to. &lt;/p&gt;</comment>
                            <comment id="15123306" author="sebb@apache.org" created="Fri, 29 Jan 2016 10:18:11 +0000"  >&lt;p&gt;I agree with Bruno - there is no code bug here.&lt;/p&gt;

&lt;p&gt;I think the problem here is the method isComment() is misleading.&lt;/p&gt;

&lt;p&gt;The name and Javadoc both suggest that a CSVRecord may either be a comment or a normal record.&lt;/p&gt;

&lt;p&gt;However the method just checks whether the record HAS a comment.&lt;/p&gt;

&lt;p&gt;So the test case is wrong, it needs to count all records, not just non-comments.&lt;br/&gt;
Furthermore, the header is counted as a record.&lt;/p&gt;

&lt;p&gt;The Javadoc needs to be corrected.&lt;br/&gt;
Possibly consider deprecating isComment and adding hasComment/isCommented method.&lt;/p&gt;</comment>
                            <comment id="15124819" author="rene.suter" created="Sat, 30 Jan 2016 09:27:40 +0000"  >&lt;p&gt;I do not agree with you. &lt;/p&gt;

&lt;p&gt;I think it must be possible to get each single line either &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;as the header line (#2)&lt;/li&gt;
	&lt;li&gt;as a comment line (#1,#4-6)&lt;/li&gt;
	&lt;li&gt;as real data (#3,#7-8).&lt;br/&gt;
You should not concatenate comment lines to one single result (each comment must be treated as a single row).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It must be possible to get each single line and write a new file where the content contains exactly the same data.&lt;br/&gt;
I agree that each row must be counted (header, comment, data, empty lines)&lt;/p&gt;</comment>
                            <comment id="15125133" author="sebb@apache.org" created="Sat, 30 Jan 2016 23:33:47 +0000"  >&lt;p&gt;It&apos;s clear from the isComment() method (and the Javadoc for the comment field) that comments are only available as part of an existing data line.&lt;/p&gt;

&lt;p&gt;If the intention had been for comments to be handled as separate records, then the comment marker would have been a boolean or it would not have been possible to have both comment and data in the same record, or there would have been a separate comment record type.&lt;/p&gt;

&lt;p&gt;This is not the case.&lt;/p&gt;

&lt;p&gt;Yes, it could originally have been done the way you want, but it was not, and changing it now is not feasible without breaking the behaviour which has been present since version 1.0.&lt;br/&gt;
The only way to change the behaviour would be to make it yet another parsing option. I personally don&apos;t think it&apos;s worth the effort. &lt;/p&gt;

&lt;p&gt;Comments are not a fundamental part of CSV parsing; it&apos;s at least possible to process them. If you want additional comment handling then write a pre-processor.&lt;/p&gt;

&lt;p&gt;Note: I have just noticed that isComment() was added since 1.2 so we can change that without needing to deprecate it.&lt;/p&gt;</comment>
                            <comment id="15125276" author="rene.suter" created="Sun, 31 Jan 2016 10:22:05 +0000"  >&lt;p&gt;OK, i got it by now!&lt;/p&gt;

&lt;p&gt;It was not clear to me that I get the comment together with the real data.&lt;br/&gt;
This was the reason why i have missed record #7. I would recommend to add this behavior to the documentation and close this Jira.&lt;/p&gt;

&lt;p&gt;Kind regards&lt;br/&gt;
Ren&#233;&lt;/p&gt;</comment>
                            <comment id="15125325" author="sebb@apache.org" created="Sun, 31 Jan 2016 13:10:43 +0000"  >&lt;p&gt;Javadoc clarified; method renamed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12779548" name="CSVProcessor.java" size="1761" author="rene.suter" created="Sat, 26 Dec 2015 11:43:33 +0000"/>
                            <attachment id="12779547" name="sample1.csv" size="245" author="rene.suter" created="Sat, 26 Dec 2015 11:42:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2qbdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>