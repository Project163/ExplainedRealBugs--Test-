<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:44:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CSV-311] OutOfMemory for very long rows despite using column value of type Reader</title>
                <link>https://issues.apache.org/jira/browse/CSV-311</link>
                <project id="12313222" key="CSV">Commons CSV</project>
                    <description>&lt;p&gt;Our application makes use of commons-csv (great software, thanks!) .&lt;/p&gt;

&lt;p&gt;Recently, we got a support request because someone had unexpectedly large column values in one CSV row - so large that our explicitly chosen limits on the java heap did not suffice.&lt;/p&gt;

&lt;p&gt;We analyzed the heap dump and found that a huge row was the culprit; the stack trace in question is&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by -&amp;gt; &#160;java.lang.OutOfMemoryError: Java heap space &#160;
&#160;Arrays.copyOf:3537 &#160;
&#160;AbstractStringBuilder.ensureCapacityInternal:228 &#160;
&#160;AbstractStringBuilder.append:802 &#160;
&#160;StringBuilder.append:246 &#160;
&#160;CSVFormat.printWithQuotes:2127 &#160;
&#160;CSVFormat.print:1834 &#160;
&#160;CSVFormat.print:1783 &#160;
&#160;CSVPrinter.print:166 &#160;
&#160;CSVPrinter.printRecord:259 &#160;
&#160;CSVPrinter.printRecord:278   &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note that we provide column values of type java.io.Reader as accepted by org.apache.commons.csv.CSVFormat.print(Object, Appendable, boolean) .&lt;/p&gt;

&lt;p&gt;The problem is that CSVFormat.print really supports java.io.Reader, but despite just piping characters (possibly escaped/quoted) into the appendable output stream, it reads everything into a StringBuilder which is then copied to the appendable output stream.&lt;/p&gt;

&lt;p&gt;Is there a way to improve this situation? We are working in a setup in which java heap cannot be spend arbitrarily and we would rather have an approach which works out of the box.&lt;/p&gt;

&lt;p&gt;Thanks for looking into it!&lt;/p&gt;</description>
                <environment></environment>
        <key id="13571462">CSV-311</key>
            <summary>OutOfMemory for very long rows despite using column value of type Reader</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cfeuersa">Christian Feuersaenger</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Mar 2024 09:59:45 +0000</created>
                <updated>Tue, 12 Mar 2024 01:23:14 +0000</updated>
                            <resolved>Mon, 11 Mar 2024 14:25:40 +0000</resolved>
                                    <version>1.10.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Printer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17825331" author="garydgregory" created="Mon, 11 Mar 2024 14:25:33 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cfeuersa&quot; class=&quot;user-hover&quot; rel=&quot;cfeuersa&quot;&gt;cfeuersa&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;This issue is fixed in git master and snapshot builds in &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-csv/1.10.1-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-csv/1.10.1-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please let us know how this works for your use case.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17825355" author="JIRAUSER304562" created="Mon, 11 Mar 2024 15:18:35 +0000"  >&lt;p&gt;Wow, I am impressed! My tests passed without any OOMs! Thank you for the fast and precise work!&lt;/p&gt;

&lt;p&gt;A side-note which is not directly related to my issue: I also looked into the code and stumbled over CSVFormat.printWithEscapes &#8211; it appears to have the very same weakness (judging from a glance at the source code). Do you think your solution might fit here as well?&#160;&lt;/p&gt;</comment>
                            <comment id="17825483" author="garydgregory" created="Tue, 12 Mar 2024 01:23:14 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cfeuersa&quot; class=&quot;user-hover&quot; rel=&quot;cfeuersa&quot;&gt;cfeuersa&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The reader version of &lt;tt&gt;printWithEscapes&lt;/tt&gt; also uses a temporary &lt;tt&gt;StringBuilder&lt;/tt&gt; so it could be improved. Feel free to provide a PR on GitHub &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1nwb4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>