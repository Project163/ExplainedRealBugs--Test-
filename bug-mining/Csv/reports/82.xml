<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:43:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CSV-135] Char escape doesn&apos;t work properly with quoting</title>
                <link>https://issues.apache.org/jira/browse/CSV-135</link>
                <project id="12313222" key="CSV">Commons CSV</project>
                    <description>&lt;p&gt;Following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CSVFormat format = CSVFormat.DEFAULT
	.withRecordSeparator(&lt;span class=&quot;code-quote&quot;&gt;&apos;\n&apos;&lt;/span&gt;)
	.withQuote(&lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&apos;&lt;/span&gt;)
	.withEscape(&lt;span class=&quot;code-quote&quot;&gt;&apos;\\&apos;&lt;/span&gt;);

CSVPrinter printer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CSVPrinter(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out, format);
List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; l = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;();
l.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;&quot;);
l.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;\n&quot;&lt;/span&gt;);
l.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;);
printer.printRecord(l);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;produces&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;&quot;,&quot;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;\&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;instead of&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;\n&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;\\&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12746395">CSV-135</key>
            <summary>Char escape doesn&apos;t work properly with quoting</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Matzz">Mateusz Zakarczemny</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Oct 2014 13:04:35 +0000</created>
                <updated>Sun, 16 Jun 2019 20:52:21 +0000</updated>
                            <resolved>Sun, 16 Jun 2019 20:25:10 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>Patch Needed</fixVersion>
                                    <component>Printer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15106219" author="garydgregory" created="Tue, 19 Jan 2016 04:19:22 +0000"  >&lt;p&gt;I can confirm that:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;l.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;does not output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But instead:&lt;/p&gt;

&lt;p&gt;does not output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which causes an EOFException in the parser if you try to read it back.&lt;/p&gt;

&lt;p&gt;But I thought that anything goes inside of quotes, which is the point of quoting...&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="15107095" author="sebb@apache.org" created="Tue, 19 Jan 2016 18:04:41 +0000"  >&lt;p&gt;Yes, anything goes inside double-quotes - except a double-quote (DQ).&lt;/p&gt;

&lt;p&gt;There are two ways to support embedded DQ: doubling the DQ, or escaping the DQ.&lt;/p&gt;

&lt;p&gt;In this case, the backslash is presumably being treated as an escape, and since the next char is a DQ, it causes the parser to run off the end of the string.&lt;br/&gt;
However, if backslash is not treated as an escape, there would be no problem with the string.&lt;/p&gt;

&lt;p&gt;AFAICT, escaping a DQ - instead of doubling it - is not a standard feature of CSV.&lt;br/&gt;
According to Wikipedia escaping is used in Sybase.&lt;br/&gt;
In which case, it suggests that the parser should default to not processing escapes in DQ strings.&lt;/p&gt;

&lt;p&gt;The fundamental problem here is that there is no single definition of what constitutes the CSV format.&lt;/p&gt;</comment>
                            <comment id="15107188" author="garydgregory" created="Tue, 19 Jan 2016 18:52:50 +0000"  >&lt;p&gt;Hi Sebb,&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The fundamental problem here is that there is no single definition of what constitutes the CSV format.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Hence the CSVFormat class and its many settings &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; It sounds like we needs a CSVFormat.SYBASE constant then? What would that look like and what additional setting do we need to toggle escaping behavior if any?&lt;/p&gt;</comment>
                            <comment id="15112219" author="sebb@apache.org" created="Fri, 22 Jan 2016 09:43:39 +0000"  >&lt;p&gt;Does it even make sense to use both quoting and escaping in the same format?&lt;br/&gt;
These are two different ways of achieving the same end, which means the output is ambiguous.&lt;/p&gt;

&lt;p&gt;It looks like both OpenOffice and Numbers (MacOSX) only use quoting.&lt;/p&gt;</comment>
                            <comment id="15112289" author="matzz" created="Fri, 22 Jan 2016 10:45:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;AFAICT, escaping a DQ - instead of doubling it - is not a standard feature of CSV.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Well as far as I know there is no CSV standard &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Does it even make sense to use both quoting and escaping in the same format?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The main question how we should handle DQ and LF if we are using quoting. We could double it or escape. From my experience Hive uses escaping (&lt;a href=&quot;https://en.wikipedia.org/wiki/Apache_Hive&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://en.wikipedia.org/wiki/Apache_Hive&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="15112344" author="sebb@apache.org" created="Fri, 22 Jan 2016 11:59:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;We could double it or escape.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s clear that if only quoting is specified, then special chars need to be protected by enclosing in quotes, and embedded quotes need to be doubled.&lt;br/&gt;
Likewise if only escaping is specified, then special chars need to be protected by escaping, and the escape character needs to be doubled.&lt;/p&gt;

&lt;p&gt;The problem arises when both quoting and escaping are specified.&lt;br/&gt;
The behaviour is then ambiguous.&lt;/p&gt;

&lt;p&gt;So the question is, do any applications use both?&lt;br/&gt;
If so, how do they resolve the ambiguity?&lt;br/&gt;
If not, we should disallow escaping and quoting.&lt;/p&gt;</comment>
                            <comment id="16859836" author="ophers" created="Mon, 10 Jun 2019 08:55:00 +0000"  >&lt;p&gt;I think this&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The problem arises when both quoting and escaping are specified.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;is &lt;em&gt;never&lt;/em&gt; the case. &lt;tt&gt;CSVFormat&lt;/tt&gt; will either do &lt;tt&gt;printWithQuotes&lt;/tt&gt; &lt;em&gt;OR&lt;/em&gt; &lt;tt&gt;printWithEscapes&lt;/tt&gt;, irrespective of setting both &lt;tt&gt;quoteCharacter&lt;/tt&gt; and &lt;tt&gt;escapeCharacter&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16865056" author="sebb@apache.org" created="Sun, 16 Jun 2019 15:34:41 +0000"  >&lt;p&gt;On the contrary, quote and escape chars can both be specified; indeed many formats do this.&lt;br/&gt;
For example ORACLE and INFORMIX_UNLOAD.&lt;/p&gt;

&lt;p&gt;For parsing, this should not be a problem, as both &amp;lt;escape&amp;gt;&amp;lt;anychar&amp;gt; and &amp;lt;quote&amp;gt;&amp;lt;anychar&amp;gt; should generate &amp;lt;anychar&amp;gt;.&lt;br/&gt;
(Be liberal in what you accept)&lt;/p&gt;

&lt;p&gt;However, for printing, if both are specified and the chars are different, which should take precedence?&lt;br/&gt;
(Be strict in what you generate)&lt;br/&gt;
This currently applies to the following formats:&lt;br/&gt;
INFORMIX_UNLOAD, ORACLE, POSTGRESQL_TEXT&lt;/p&gt;</comment>
                            <comment id="16865078" author="opher" created="Sun, 16 Jun 2019 16:52:52 +0000"  >&lt;p&gt;On the printing front&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;font color=&quot;#333333&quot;&gt;However, for printing, if both are specified and the chars are different, which should take precedence?&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#333333&quot;&gt; (Be strict in what you generate)&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is &lt;b&gt;&lt;em&gt;exactly&lt;/em&gt;&lt;/b&gt; where &lt;font color=&quot;#14892c&quot;&gt;&lt;b&gt;QuoteMode&lt;/b&gt;&lt;/font&gt; comes into play: If it is &lt;b&gt;NONE&lt;/b&gt; then it is strictly &lt;ins&gt;&lt;em&gt;print-with-escapes&lt;/em&gt;&lt;/ins&gt;, otherwise it&apos;s some flavor of Quoting.&lt;/p&gt;

&lt;p&gt;For parsing how would you parse a record such as?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;ID,Address,Image Path,Document Path&lt;br/&gt;
1,&quot;3rd Lincoln boulevard\, Miami\, FL&quot;,D:\Images\Houses\ID_1.png,&quot;D:\Property Documents\ID 1.docx&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16865147" author="sebb@apache.org" created="Sun, 16 Jun 2019 20:13:49 +0000"  >&lt;p&gt;The problem is two fold:&lt;br/&gt;
1) &lt;tt&gt;printWithQuotes&lt;/tt&gt; does not check for embedded escapes when deciding whether to encapsulate the value&lt;br/&gt;
2) it does not escape embedded escape chars in the value&lt;/p&gt;</comment>
                            <comment id="16865149" author="sebb@apache.org" created="Sun, 16 Jun 2019 20:18:44 +0000"  >&lt;p&gt;This fixes the problem as originally reported.&lt;/p&gt;

&lt;p&gt;f7c2ca2  &lt;a href=&quot;https://issues.apache.org/jira/browse/CSV-135&quot; title=&quot;Char escape doesn&amp;#39;t work properly with quoting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CSV-135&quot;&gt;&lt;del&gt;CSV-135&lt;/del&gt;&lt;/a&gt; - Char escape doesn&apos;t work&lt;/p&gt;

&lt;p&gt;If there are related problems, please raise a separate issue.&lt;/p&gt;</comment>
                            <comment id="16865150" author="sebb@apache.org" created="Sun, 16 Jun 2019 20:20:15 +0000"  >&lt;blockquote&gt;&lt;p&gt;This is exactly where QuoteMode comes into play: If it is NONE then it is strictly print-with-escapes, otherwise it&apos;s some flavor of Quoting.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, but the other QuoteMode settings failed to take account of embedded escapes.&lt;/p&gt;</comment>
                            <comment id="16865153" author="sebb@apache.org" created="Sun, 16 Jun 2019 20:25:10 +0000"  >&lt;p&gt;7754cd4  &lt;a href=&quot;https://issues.apache.org/jira/browse/CSV-135&quot; title=&quot;Char escape doesn&amp;#39;t work properly with quoting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CSV-135&quot;&gt;&lt;del&gt;CSV-135&lt;/del&gt;&lt;/a&gt; - Char escape doesn&apos;t work properly with quoting&lt;/p&gt;</comment>
                            <comment id="16865157" author="opher" created="Sun, 16 Jun 2019 20:52:21 +0000"  >&lt;p&gt;Sorry, I probably did not make my point clear before.&lt;br/&gt;
 If the field value is:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&quot;D:\Property Documents\ID 1.docx&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;the `\` is obviously a literal not an escape. While for&#160;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&quot;3rd Lincoln boulevard\, Miami\, FL&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;the `\` may or may-not be an escape.&lt;/p&gt;

&lt;p&gt;The solution could be by adding a new flag (or a new &lt;tt&gt;enum&lt;/tt&gt;) that modifies &lt;tt&gt;QuoteMode&lt;/tt&gt;&apos;s handling by making it explicit whether `\`&#160;are literals, or an escape only if followed by specific chars (i.e. `,`,`\`) or always an escape.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 21 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20vr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>