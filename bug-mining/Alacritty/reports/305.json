{"url":"https://api.github.com/repos/alacritty/alacritty/issues/8277","repository_url":"https://api.github.com/repos/alacritty/alacritty","labels_url":"https://api.github.com/repos/alacritty/alacritty/issues/8277/labels{/name}","comments_url":"https://api.github.com/repos/alacritty/alacritty/issues/8277/comments","events_url":"https://api.github.com/repos/alacritty/alacritty/issues/8277/events","html_url":"https://github.com/alacritty/alacritty/issues/8277","id":2619851982,"node_id":"I_kwDOAxkop86cJ8TO","number":8277,"title":"Highlighted hints use old data for their actions","user":{"login":"chrisduerr","id":8886672,"node_id":"MDQ6VXNlcjg4ODY2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/8886672?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisduerr","html_url":"https://github.com/chrisduerr","followers_url":"https://api.github.com/users/chrisduerr/followers","following_url":"https://api.github.com/users/chrisduerr/following{/other_user}","gists_url":"https://api.github.com/users/chrisduerr/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisduerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisduerr/subscriptions","organizations_url":"https://api.github.com/users/chrisduerr/orgs","repos_url":"https://api.github.com/users/chrisduerr/repos","events_url":"https://api.github.com/users/chrisduerr/events{/privacy}","received_events_url":"https://api.github.com/users/chrisduerr/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":327960155,"node_id":"MDU6TGFiZWwzMjc5NjAxNTU=","url":"https://api.github.com/repos/alacritty/alacritty/labels/B%20-%20bug","name":"B - bug","color":"c6071e","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/alacritty/alacritty/milestones/30","html_url":"https://github.com/alacritty/alacritty/milestone/30","labels_url":"https://api.github.com/repos/alacritty/alacritty/milestones/30/labels","id":11809029,"node_id":"MI_kwDOAxkop84AtDEF","number":30,"title":"Version 0.15.0","description":"","creator":{"login":"kchibisov","id":27620401,"node_id":"MDQ6VXNlcjI3NjIwNDAx","avatar_url":"https://avatars.githubusercontent.com/u/27620401?v=4","gravatar_id":"","url":"https://api.github.com/users/kchibisov","html_url":"https://github.com/kchibisov","followers_url":"https://api.github.com/users/kchibisov/followers","following_url":"https://api.github.com/users/kchibisov/following{/other_user}","gists_url":"https://api.github.com/users/kchibisov/gists{/gist_id}","starred_url":"https://api.github.com/users/kchibisov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kchibisov/subscriptions","organizations_url":"https://api.github.com/users/kchibisov/orgs","repos_url":"https://api.github.com/users/kchibisov/repos","events_url":"https://api.github.com/users/kchibisov/events{/privacy}","received_events_url":"https://api.github.com/users/kchibisov/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":8,"state":"closed","created_at":"2024-10-28T20:03:53Z","updated_at":"2025-01-30T20:01:42Z","due_on":null,"closed_at":"2025-01-30T20:01:09Z"},"comments":0,"created_at":"2024-10-29T00:38:34Z","updated_at":"2024-11-02T20:05:53Z","closed_at":"2024-11-02T20:05:53Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Currently the following logic is used to open hints with the mouse/vi mode:\r\n\r\n```rust\r\n                let hint = ctx.display().vi_highlighted_hint.take();\r\n                if let Some(hint) = &hint {\r\n                    ctx.trigger_hint(hint);\r\n                }\r\n                ctx.display().vi_highlighted_hint = hint;\r\n```\r\n\r\n```rust\r\n        let hint = self.ctx.display().highlighted_hint.take();\r\n        if let Some(hint) = hint.as_ref().filter(|_| button == MouseButton::Left) {\r\n            self.ctx.trigger_hint(hint);\r\n        }\r\n        self.ctx.display().highlighted_hint = hint;\r\n```\r\n\r\nBoth of these take the current highlighted hint and pass it directly to `trigger_hint`. However `trigger_hint` uses the following logic to convert the hint to its text equivalent:\r\n\r\n```rust\r\n        let hint_bounds = hint.bounds();\r\n        let text = match hint.hyperlink() {\r\n            Some(hyperlink) => hyperlink.uri().to_owned(),\r\n            None => self.terminal.bounds_to_string(*hint_bounds.start(), *hint_bounds.end()),\r\n        };\r\n```\r\n\r\nThis is problematic since the highlighted hint has not been checked for validity since the last frame, which means the underlying terminal content could have changed since the user requested its opening.\r\n\r\nTo avoid accidentally opening arbitrary text, Alacritty should either invalidate the highlighted hints before passing them to the `trigger_hint` function or recreate the hints.\r\n\r\nIf the hints are recreated, we might also be able to remove the ugly `take()` -> `assign` stuff.","closed_by":{"login":"chrisduerr","id":8886672,"node_id":"MDQ6VXNlcjg4ODY2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/8886672?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisduerr","html_url":"https://github.com/chrisduerr","followers_url":"https://api.github.com/users/chrisduerr/followers","following_url":"https://api.github.com/users/chrisduerr/following{/other_user}","gists_url":"https://api.github.com/users/chrisduerr/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisduerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisduerr/subscriptions","organizations_url":"https://api.github.com/users/chrisduerr/orgs","repos_url":"https://api.github.com/users/chrisduerr/repos","events_url":"https://api.github.com/users/chrisduerr/events{/privacy}","received_events_url":"https://api.github.com/users/chrisduerr/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/alacritty/alacritty/issues/8277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/alacritty/alacritty/issues/8277/timeline","performed_via_github_app":null,"state_reason":"completed"}