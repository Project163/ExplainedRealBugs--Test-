{"url":"https://api.github.com/repos/alacritty/alacritty/issues/4977","repository_url":"https://api.github.com/repos/alacritty/alacritty","labels_url":"https://api.github.com/repos/alacritty/alacritty/issues/4977/labels{/name}","comments_url":"https://api.github.com/repos/alacritty/alacritty/issues/4977/comments","events_url":"https://api.github.com/repos/alacritty/alacritty/issues/4977/events","html_url":"https://github.com/alacritty/alacritty/issues/4977","id":858705910,"node_id":"MDU6SXNzdWU4NTg3MDU5MTA=","number":4977,"title":"Crash when coming back from full screen on i3","user":{"login":"Eijebong","id":3650385,"node_id":"MDQ6VXNlcjM2NTAzODU=","avatar_url":"https://avatars.githubusercontent.com/u/3650385?v=4","gravatar_id":"","url":"https://api.github.com/users/Eijebong","html_url":"https://github.com/Eijebong","followers_url":"https://api.github.com/users/Eijebong/followers","following_url":"https://api.github.com/users/Eijebong/following{/other_user}","gists_url":"https://api.github.com/users/Eijebong/gists{/gist_id}","starred_url":"https://api.github.com/users/Eijebong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Eijebong/subscriptions","organizations_url":"https://api.github.com/users/Eijebong/orgs","repos_url":"https://api.github.com/users/Eijebong/repos","events_url":"https://api.github.com/users/Eijebong/events{/privacy}","received_events_url":"https://api.github.com/users/Eijebong/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":327960155,"node_id":"MDU6TGFiZWwzMjc5NjAxNTU=","url":"https://api.github.com/repos/alacritty/alacritty/labels/B%20-%20bug","name":"B - bug","color":"c6071e","default":false,"description":""},{"id":638297569,"node_id":"MDU6TGFiZWw2MzgyOTc1Njk=","url":"https://api.github.com/repos/alacritty/alacritty/labels/B%20-%20crash","name":"B - crash","color":"c6071e","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-04-15T09:49:25Z","updated_at":"2021-04-15T22:16:32Z","closed_at":"2021-04-15T22:16:32Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Opening alacritty, setting it to full screen and coming back gets it to crash with the following backtrace:\r\n\r\n```\r\nthread 'main' panicked at 'index out of bounds: the len is 1016 but the index is 18446744073709550580', /data/code/alacritty/alacritty_terminal/src/term/search.rs:404:16\r\nstack backtrace:\r\n   0: rust_begin_unwind\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:493:5\r\n   1: core::panicking::panic_fmt\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/panicking.rs:92:14\r\n   2: core::panicking::panic_bounds_check\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/panicking.rs:69:5\r\n   3: <usize as core::slice::index::SliceIndex<[T]>>::index\r\n             at ./.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/slice/index.rs:182:10\r\n   4: core::slice::index::<impl core::ops::index::Index<I> for [T]>::index\r\n             at ./.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/slice/index.rs:15:9\r\n   5: <alloc::vec::Vec<T,A> as core::ops::index::Index<I>>::index\r\n             at ./.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/vec/mod.rs:2386:9\r\n   6: <alacritty_terminal::grid::storage::Storage<T> as core::ops::index::Index<alacritty_terminal::index::Line>>::index\r\n             at /data/code/alacritty/alacritty_terminal/src/grid/storage.rs:255:10\r\n   7: <alacritty_terminal::grid::Grid<T> as core::ops::index::Index<alacritty_terminal::index::Line>>::index\r\n             at /data/code/alacritty/alacritty_terminal/src/grid/mod.rs:446:10\r\n   8: alacritty_terminal::term::search::<impl alacritty_terminal::term::Term<T>>::line_search_left\r\n             at /data/code/alacritty/alacritty_terminal/src/term/search.rs:404:16\r\n   9: alacritty::display::hint::highlighted_at::{{closure}}::{{closure}}\r\n             at /data/code/alacritty/alacritty/src/display/hint.rs:264:29\r\n  10: alacritty::config::ui_config::LazyRegex::with_compiled\r\n             at /data/code/alacritty/alacritty/src/config/ui_config.rs:359:9\r\n  11: alacritty::display::hint::highlighted_at::{{closure}}\r\n             at /data/code/alacritty/alacritty/src/display/hint.rs:262:9\r\n  12: <core::slice::iter::Iter<T> as core::iter::traits::iterator::Iterator>::find_map\r\n             at ./.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/slice/iter/macros.rs:268:38\r\n  13: alacritty::display::hint::highlighted_at\r\n             at /data/code/alacritty/alacritty/src/display/hint.rs:251:5\r\n  14: alacritty::display::Display::update_highlighted_hints\r\n             at /data/code/alacritty/alacritty/src/display/mod.rs:684:32\r\n  15: alacritty::event::Processor<N>::run::{{closure}}\r\n             at /data/code/alacritty/alacritty/src/event.rs:1092:17\r\n  16: winit::platform_impl::platform::sticky_exit_callback\r\n             at ./.cargo/registry/src/github.com-1ecc6299db9ec823/winit-0.24.0/src/platform_impl/linux/mod.rs:736:5\r\n  17: winit::platform_impl::platform::x11::EventLoop<T>::run_return\r\n             at ./.cargo/registry/src/github.com-1ecc6299db9ec823/winit-0.24.0/src/platform_impl/linux/x11/mod.rs:330:17\r\n  18: winit::platform_impl::platform::EventLoop<T>::run_return\r\n             at ./.cargo/registry/src/github.com-1ecc6299db9ec823/winit-0.24.0/src/platform_impl/linux/mod.rs:645:56\r\n  19: <winit::event_loop::EventLoop<T> as winit::platform::run_return::EventLoopExtRunReturn>::run_return\r\n             at ./.cargo/registry/src/github.com-1ecc6299db9ec823/winit-0.24.0/src/platform/run_return.rs:56:9\r\n  20: alacritty::event::Processor<N>::run\r\n             at /data/code/alacritty/alacritty/src/event.rs:1004:9\r\n  21: alacritty::run\r\n             at /data/code/alacritty/alacritty/src/main.rs:204:5\r\n  22: alacritty::main\r\n             at /data/code/alacritty/alacritty/src/main.rs:102:23\r\n  23: core::ops::function::FnOnce::call_once\r\n             at ./.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227:5\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n```\r\n\r\nFull logs:\r\n\r\n```\r\n[bastien@radium] ~  >>> alacritty -vv\r\nCreated log file at \"/tmp/Alacritty-13162.log\"\r\n[2021-04-15 11:44:22.139715594] [INFO ] [alacritty] Welcome to Alacritty\r\n[2021-04-15 11:44:22.139812206] [INFO ] [alacritty] Configuration files loaded from:\r\n                                                      \"/home/bastien/.config/alacritty/alacritty.yml\"\r\n[2021-04-15 11:44:22.163778686] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Regular, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-04-15 11:44:22.165940320] [DEBUG] [alacritty] Estimated DPR: 1\r\n[2021-04-15 11:44:22.165964394] [DEBUG] [alacritty] Estimated window size: None\r\n[2021-04-15 11:44:22.165983072] [DEBUG] [alacritty] Estimated cell size: 11 x 21\r\n[2021-04-15 11:44:22.255347655] [INFO ] [alacritty] Device pixel ratio: 1\r\n[2021-04-15 11:44:22.258177305] [INFO ] [alacritty] Initializing glyph cache...\r\n[2021-04-15 11:44:22.267867524] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Regular, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-04-15 11:44:22.279999027] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Bold, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-04-15 11:44:22.292210163] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Italic, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-04-15 11:44:22.304621353] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Bold Italic, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-04-15 11:44:22.313495327] [INFO ] [alacritty] ... finished initializing glyph cache in 0.055287523s\r\n[2021-04-15 11:44:22.313608107] [INFO ] [alacritty] Cell size: 11 x 21\r\n[2021-04-15 11:44:22.313623892] [INFO ] [alacritty] Padding: 0 x 0\r\n[2021-04-15 11:44:22.313633593] [INFO ] [alacritty] Width: 800, Height: 600\r\n[2021-04-15 11:44:22.322797743] [INFO ] [alacritty] PTY dimensions: 28 x 72\r\n[2021-04-15 11:44:22.328271064] [INFO ] [alacritty] Initialisation complete\r\n[2021-04-15 11:44:22.442737023] [DEBUG] [alacritty_terminal] New num_cols is 174 and num_lines is 16\r\n[2021-04-15 11:44:22.459334951] [INFO ] [alacritty] Padding: 0 x 0\r\n[2021-04-15 11:44:22.459385930] [INFO ] [alacritty] Width: 1918, Height: 344\r\n[2021-04-15 11:44:23.008925015] [DEBUG] [alacritty_terminal] New num_cols is 174 and num_lines is 51\r\n[2021-04-15 11:44:23.061543201] [INFO ] [alacritty] Padding: 0 x 0\r\n[2021-04-15 11:44:23.061616294] [INFO ] [alacritty] Width: 1920, Height: 1080\r\n[2021-04-15 11:44:23.423543864] [DEBUG] [alacritty_terminal] New num_cols is 174 and num_lines is 16\r\n[2021-04-15 11:44:23.459638590] [INFO ] [alacritty] Padding: 0 x 0\r\n[2021-04-15 11:44:23.459681849] [INFO ] [alacritty] Width: 1918, Height: 344\r\nthread 'main' panicked at 'index out of bounds: the len is 1016 but the index is 18446744073709550577', /data/code/alacritty/alacritty_terminal/src/term/search.rs:404:16\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n```\r\n\r\nNote that it doesn't happen with every geometry and seems to be linked to the size of the window on opening. Opening a terminal on an empty workspace, going fullscreen and then back doesn't trigger the crash. Opening a second one while splitting vertically and trying to reproduce the bug only works with the newly opened one, not the original one even though their current size is the same.\r\n","closed_by":{"login":"chrisduerr","id":8886672,"node_id":"MDQ6VXNlcjg4ODY2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/8886672?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisduerr","html_url":"https://github.com/chrisduerr","followers_url":"https://api.github.com/users/chrisduerr/followers","following_url":"https://api.github.com/users/chrisduerr/following{/other_user}","gists_url":"https://api.github.com/users/chrisduerr/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisduerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisduerr/subscriptions","organizations_url":"https://api.github.com/users/chrisduerr/orgs","repos_url":"https://api.github.com/users/chrisduerr/repos","events_url":"https://api.github.com/users/chrisduerr/events{/privacy}","received_events_url":"https://api.github.com/users/chrisduerr/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/alacritty/alacritty/issues/4977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/alacritty/alacritty/issues/4977/timeline","performed_via_github_app":null,"state_reason":"completed"}