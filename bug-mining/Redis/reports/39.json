{"url":"https://api.github.com/repos/redis/redis/issues/3343","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/3343/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/3343/comments","events_url":"https://api.github.com/repos/redis/redis/issues/3343/events","html_url":"https://github.com/redis/redis/issues/3343","id":162073634,"node_id":"MDU6SXNzdWUxNjIwNzM2MzQ=","number":3343,"title":"3.2.1 crash when as slave node sync with master","user":{"login":"luweijie007","id":7186190,"node_id":"MDQ6VXNlcjcxODYxOTA=","avatar_url":"https://avatars.githubusercontent.com/u/7186190?v=4","gravatar_id":"","url":"https://api.github.com/users/luweijie007","html_url":"https://github.com/luweijie007","followers_url":"https://api.github.com/users/luweijie007/followers","following_url":"https://api.github.com/users/luweijie007/following{/other_user}","gists_url":"https://api.github.com/users/luweijie007/gists{/gist_id}","starred_url":"https://api.github.com/users/luweijie007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luweijie007/subscriptions","organizations_url":"https://api.github.com/users/luweijie007/orgs","repos_url":"https://api.github.com/users/luweijie007/repos","events_url":"https://api.github.com/users/luweijie007/events{/privacy}","received_events_url":"https://api.github.com/users/luweijie007/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":155760,"node_id":"MDU6TGFiZWwxNTU3NjA=","url":"https://api.github.com/repos/redis/redis/labels/critical%20bug","name":"critical bug","color":"e10c02","default":false,"description":null},{"id":1198954,"node_id":"MDU6TGFiZWwxMTk4OTU0","url":"https://api.github.com/repos/redis/redis/labels/crash%20report","name":"crash report","color":"e10c02","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":21,"created_at":"2016-06-24T04:25:25Z","updated_at":"2017-01-26T13:51:49Z","closed_at":"2017-01-26T13:51:49Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"log as below:\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\n27648:S 24 Jun 12:16:32.265 # Redis 3.2.1 crashed by signal: 11\n27648:S 24 Jun 12:16:32.265 # Crashed running the instuction at: 0x431599\n27648:S 24 Jun 12:16:32.265 # Accessing address: 0x7fd7dc299d1e\n27648:S 24 Jun 12:16:32.265 # Failed assertion: <no assertion failed> (<no file>:0)\n\n------ STACK TRACE ------\nEIP:\n./redis-server *:6400 [cluster][0x431599]\n\nBacktrace:\n./redis-server *:6400 [cluster](logStackTrace+0x29)[0x45caa9]\n./redis-server *:6400 [cluster](sigsegvHandler+0xaa)[0x45cf9a]\n/lib64/libpthread.so.0(+0xf130)[0x7fd79b0c0130]\n./redis-server *:6400 [cluster][0x431599]\n./redis-server *:6400 [cluster](quicklistReplaceAtIndex+0x51)[0x420381]\n./redis-server *:6400 [cluster](lsetCommand+0xb4)[0x4453e4]\n./redis-server *:6400 [cluster](call+0x85)[0x426935]\n./redis-server *:6400 [cluster](processCommand+0x367)[0x429947]\n./redis-server *:6400 [cluster](processInputBuffer+0x105)[0x4362b5]\n./redis-server *:6400 [cluster](aeProcessEvents+0x218)[0x4210b8]\n./redis-server *:6400 [cluster](aeMain+0x2b)[0x42136b]\n./redis-server *:6400 [cluster](main+0x40f)[0x41e35f]\n/lib64/libc.so.6(__libc_start_main+0xf5)[0x7fd79ad11af5]\n./redis-server *:6400 [cluster][0x41e5e5]\n\n------ INFO OUTPUT ------\n# Server\n\nredis_version:3.2.1\nredis_git_sha1:00000000\nredis_git_dirty:0\nredis_build_id:42468865c010fa71\nredis_mode:cluster\nos:Linux 3.10.0-123.el7.x86_64 x86_64\narch_bits:64\nmultiplexing_api:epoll\ngcc_version:4.8.3\nprocess_id:27648\nrun_id:61d307b257465f360b038ca9e7227729c8f7fc55\ntcp_port:6400\nuptime_in_seconds:329\nuptime_in_days:0\nhz:10\nlru_clock:7124000\nexecutable:/home/redis/redis-3.2.1/src/./redis-server\nconfig_file:/home/redis/redis-3.2.1/redis.conf\n# Clients\n\nconnected_clients:2\nclient_longest_output_list:0\nclient_biggest_input_buf:14962\nblocked_clients:0\n# Memory\n\nused_memory:2989199160\nused_memory_human:2.78G\nused_memory_rss:3073859584\nused_memory_rss_human:2.86G\nused_memory_peak:2989199160\nused_memory_peak_human:2.78G\ntotal_system_memory:16609554432\ntotal_system_memory_human:15.47G\nused_memory_lua:37888\nused_memory_lua_human:37.00K\nmaxmemory:0\nmaxmemory_human:0B\nmaxmemory_policy:noeviction\nmem_fragmentation_ratio:1.03\nmem_allocator:jemalloc-4.0.3\n# Persistence\n\nloading:0\nrdb_changes_since_last_save:14\nrdb_bgsave_in_progress:0\nrdb_last_save_time:1466741463\nrdb_last_bgsave_status:ok\nrdb_last_bgsave_time_sec:-1\nrdb_current_bgsave_time_sec:-1\naof_enabled:0\naof_rewrite_in_progress:0\naof_rewrite_scheduled:0\naof_last_rewrite_time_sec:-1\naof_current_rewrite_time_sec:-1\naof_last_bgrewrite_status:ok\naof_last_write_status:ok\n# Stats\n\ntotal_connections_received:1\ntotal_commands_processed:18\ninstantaneous_ops_per_sec:0\ntotal_net_input_bytes:1151760372\ntotal_net_output_bytes:1040\ninstantaneous_input_kbps:49380.11\ninstantaneous_output_kbps:0.00\nrejected_connections:0\nsync_full:0\nsync_partial_ok:0\nsync_partial_err:0\nexpired_keys:0\nevicted_keys:0\nkeyspace_hits:0\nkeyspace_misses:0\npubsub_channels:0\npubsub_patterns:0\nlatest_fork_usec:0\nmigrate_cached_sockets:0\n# Replication\n\nrole:slave\nmaster_host:10.15.144.103\nmaster_port:6400\nmaster_link_status:up\nmaster_last_io_seconds_ago:0\nmaster_sync_in_progress:0\nslave_repl_offset:9950243389\nslave_priority:100\nslave_read_only:1\nconnected_slaves:0\nmaster_repl_offset:0\nrepl_backlog_active:0\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:0\nrepl_backlog_histlen:0\n# CPU\n\nused_cpu_sys:9.85\nused_cpu_user:13.29\nused_cpu_sys_children:0.00\nused_cpu_user_children:0.00\n# Commandstats\n\ncmdstat_rpush:calls=2,usec=13,usec_per_call=6.50\ncmdstat_lset:calls=12,usec=24,usec_per_call=2.00\ncmdstat_select:calls=1,usec=2,usec_per_call=2.00\ncmdstat_cluster:calls=3,usec=805,usec_per_call=268.33\n# Cluster\n\ncluster_enabled:1\n# Keyspace\n\ndb0:keys=410635,expires=0,avg_ttl=0\nhash_init_value: 1466527529\n\n------ CLIENT LIST OUTPUT ------\nid=2 addr=10.15.107.143:56641 fd=9 name= age=146 idle=64 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=cluster\nid=3 addr=10.15.144.103:6400 fd=24 name= age=0 idle=0 flags=M db=0 sub=0 psub=0 multi=-1 qbuf=14962 qbuf-free=17806 obl=0 oll=0 omem=0 events=r cmd=lset\n\n------ CURRENT CLIENT INFO ------\nid=3 addr=10.15.144.103:6400 fd=24 name= age=0 idle=0 flags=M db=0 sub=0 psub=0 multi=-1 qbuf=14962 qbuf-free=17806 obl=0 oll=0 omem=0 events=r cmd=lset\nargv[0]: 'LSET'\nargv[1]: '660FXU'\nargv[2]: '-1'\nargv[3]: S N0'\n27648:S 24 Jun 12:16:32.266 # key '660FXU' found in DB containing the following object:\n27648:S 24 Jun 12:16:32.266 # Object type: 1\n27648:S 24 Jun 12:16:32.266 # Object encoding: 9\n27648:S 24 Jun 12:16:32.266 # Object refcount: 1\n27648:S 24 Jun 12:16:32.266 # List length: 1\n\n------ REGISTERS ------\n27648:S 24 Jun 12:16:32.266 # \nRAX:00000000000000ff RBX:000000000000001a\nRCX:000000000000001a RDX:00007fd6dd090f93\nRDI:00007fd7dc299d1e RSI:00007fd6dc299d3a\nRBP:00007fd761292640 RSP:00007fffbe24d110\nR8 :00007fd6dc299d30 R9 :00007fd79aa00180\nR10:0000000000000022 R11:00007fd79420eea0\nR12:0000000000000000 R13:000000000000001a\nR14:00007fd6dc299d3a R15:000000000000000b\nRIP:0000000000431599 EFL:0000000000010206\nCSGSFS:cd00000000000033\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d11f) -> 00007fd761292660\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d11e) -> 000000000000001a\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d11d) -> 000000000000000a\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d11c) -> 00007fd7612934d8\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d11b) -> 00007fffbe24d1d0\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d11a) -> 0000000000000001\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d119) -> 00000000075bcd15\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d118) -> 00007f0000000002\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d117) -> 0000000000000001\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d116) -> 0000000000000001\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d115) -> 00007fd6dd090f93\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d114) -> 00007f0000000002\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d113) -> 0000001a00000001\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d112) -> 0000000000000001\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d111) -> 0000001c00000028\n27648:S 24 Jun 12:16:32.266 # (00007fffbe24d110) -> 00007fd79aa00080\n\n------ FAST MEMORY TEST ------\n27648:S 24 Jun 12:16:32.267 # Bio thread for job type #0 terminated\n27648:S 24 Jun 12:16:32.267 # Bio thread for job type #1 terminated\n**\\* Preparing to test memory region 722000 (114688 bytes)\n**\\* Preparing to test memory region 1c75000 (135168 bytes)\n**\\* Preparing to test memory region 7fd6dbe00000 (3072327680 bytes)\n**\\* Preparing to test memory region 7fd7931ff000 (8388608 bytes)\n**\\* Preparing to test memory region 7fd793a00000 (8388608 bytes)\n**\\* Preparing to test memory region 7fd794200000 (2097152 bytes)\n**\\* Preparing to test memory region 7fd79aa00000 (2097152 bytes)\n**\\* Preparing to test memory region 7fd79b0ac000 (20480 bytes)\n**\\* Preparing to test memory region 7fd79b2c9000 (16384 bytes)\n**\\* Preparing to test memory region 7fd79b9c7000 (16384 bytes)\n**\\* Preparing to test memory region 7fd79b9f1000 (4096 bytes)\n**\\* Preparing to test memory region 7fd79b9f2000 (4096 bytes)\n**\\* Preparing to test memory region 7fd79b9f5000 (4096 bytes)\n.O.O.O.O.O.O.O.O.O.O.O.O.O\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\n=== REDIS BUG REPORT END. Make sure to include from START to END. ===\n\n```\n   Please report the crash by opening an issue on github:\n\n       http://github.com/antirez/redis/issues\n```\n\n  Suspect RAM error? Use redis-server --test-memory to verify it.\n\nthanks!\n","closed_by":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/redis/redis/issues/3343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/3343/timeline","performed_via_github_app":null,"state_reason":"completed"}