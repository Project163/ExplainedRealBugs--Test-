[{"id":4261086,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQyNjEwODY=","url":"https://api.github.com/repos/redis/redis/issues/events/4261086","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-10-15T17:24:04Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2419777","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2419777","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2419777,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MTk3Nzc=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-16T07:38:02Z","updated_at":"2011-10-16T07:38:02Z","body":"Thank you Jeremy,\n\nplease if it is easy for you to obtain it could you send the exact git commit that you were using, and if possible even the redis-server executable itself? Thanks!\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2419777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4269328,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQyNjkzMjg=","url":"https://api.github.com/repos/redis/redis/issues/events/4269328","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-10-16T07:38:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2424444","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2424444","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2424444,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MjQ0NDQ=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-17T02:41:09Z","updated_at":"2011-10-17T02:41:09Z","body":"Argh.  I can get the binary, yes.  But apparently there's a step in the build process I've been using (only when building from the git repo) that removes the git info along the way.  That's fixed now but I can say exactly which 2.3.10 this was.\n\nhttp://jeremy.zawodny.com/tmp/redis-server\n\nThat's the binary that was running.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2424444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2425707","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2425707","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2425707,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MjU3MDc=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-17T07:22:55Z","updated_at":"2011-10-17T07:22:55Z","body":"Thank you Jeremy, the binary will be helpful.\nThe bug is an extremely difficult one to track as it happens in a place where the stack trace generated is basically the same for every kind of command received, so there is very little state information we have.\n\nHowever at a first glance it appears to be due to a corruption in the client structure output buffer.\nI'm pretty sure I never saw something like that in 2.2, so I'll try to diff the two branches to check what we changed in the buffer handling, and how this may happen.\n\nPlease could you tell me if that instance is using blocking operations? In general a list of commands and features used would be extremely useful given that we have almost no other state.\n\nThanks!\nSalvatore\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2425707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2432684","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2432684","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2432684,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzI2ODQ=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-17T18:23:18Z","updated_at":"2011-10-17T18:23:18Z","body":"Interestingly, I found another instance that had crashed as well.  The trace is below.\n\nOther noteworthy item: this has only happened on _slaves_ so far.  Slaves that, typically, get no read traffic.  They're effectively used as hot-sandby instances in case their master fails.\n\nI'm inclined to deploy 2.4.1 today to see what that looks like, unless you'd prefer I keep running 2.3.10 to help track this down.\n\nTrace:\n\n[2618] 15 Oct 09:03:51 # ======= Ooops! Redis 2.3.10 got signal: -11- =======\n[2618] 15 Oct 09:03:51 # redis_version:2.3.10\nredis_git_sha1:00000000\nredis_git_dirty:0\narch_bits:64\nmultiplexing_api:epoll\nprocess_id:2618\nuptime_in_seconds:749340\nuptime_in_days:8\nlru_clock:1846039\nused_cpu_sys:3233.74\nused_cpu_user:2282.14\nused_cpu_sys_children:0.00\nused_cpu_user_children:0.00\nconnected_clients:1\nconnected_slaves:0\nclient_longest_output_list:0\nclient_biggest_input_buf:18446744071562068008\nblocked_clients:0\nused_memory:7875902744\nused_memory_human:7.34G\nused_memory_rss:5669847040\nused_memory_peak:7875911272\nused_memory_peak_human:7.34G\nmem_fragmentation_ratio:0.72\nmem_allocator:jemalloc-2.2.1\nloading:0\naof_enabled:0\nchanges_since_last_save:122674687\nbgsave_in_progress:0\nlast_save_time:1317945291\nbgrewriteaof_in_progress:0\ntotal_connections_received:38705\ntotal_commands_processed:120850097\nexpired_keys:25\nevicted_keys:0\nkeyspace_hits:39590911\nkeyspace_misses:13297103\nhash_max_zipmap_entries:512  \nhash_max_zipmap_value:512\npubsub_channels:0\npubsub_patterns:0\nlatest_fork_usec:0\n[2618] 15 Oct 09:03:51 # /lib64/libc.so.6(memcpy+0xe1) [0x7f08a2197e21]\n[2618] 15 Oct 09:03:51 # /lib64/libc.so.6(memcpy+0xe1) [0x7f08a2197e21]\n[2618] 15 Oct 09:03:51 # /usr/bin/redis-server(sdscatlen+0x54) [0x412ce4]\n[2618] 15 Oct 09:03:51 # /usr/bin/redis-server(readQueryFromClient+0x33) [0x418f93]\n[2618] 15 Oct 09:03:51 # /usr/bin/redis-server(aeProcessEvents+0x16e) [0x40d13e]\n[2618] 15 Oct 09:03:51 # /usr/bin/redis-server(aeMain+0x2e) [0x40d35e]\n[2618] 15 Oct 09:03:51 # /usr/bin/redis-server(main+0xf9) [0x412529]\n[2618] 15 Oct 09:03:51 # /lib64/libc.so.6(__libc_start_main+0xe6) [0x7f08a2136586]\n[2618] 15 Oct 09:03:51 # /usr/bin/redis-server [0x40c649]\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2432684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2433973","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2433973","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2433973,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzM5NzM=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-17T20:01:18Z","updated_at":"2011-10-17T20:01:18Z","body":"That's interesting Jeremy! Not only slaves don't get read queries, but they have a single client for long time.\nAnd this is happening on the client structure. This is definitely more info that can help tracing the bug.\n\nThanks! Now I've enough information to start a serious investigation tomorrow.\n\nMore news soon.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2433973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2434029","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2434029","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2434029,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzQwMjk=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-17T20:05:16Z","updated_at":"2011-10-17T20:05:16Z","body":"p.s. interesting how apparently after the bug we can't see the full INFO output.\nThis should be fixed in 2.4 if I remember correctly, so upgrading is worth it even to get full stack traces ;)\n\nAnother interesting thing:\n\n```\nclient_biggest_input_buf:18446744071562068008\n```\n\nVery similar to the previous instance, this huge number makes me feel that there is an overflow issue there, like subtracting something bigger than the previous value, leading to this huge value (it wraps from 0 to the other end, I guess).\n\nThis is definitely another big hint.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2434029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2435021","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2435021","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2435021,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzUwMjE=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-17T21:26:17Z","updated_at":"2011-10-17T21:32:03Z","body":"Interestingly, there is a third instance in our environment that died in the same fashion.  So whatever happened has at least been reproduced 3 times in our environment.  We've tightened up our monitoring so that we'll see these more quickly in the future as well.\n\nTo put the 3 in perspective, we have a total of 80 nodes, 40 in each data center.  There are 20 hosts involved and each one runs 4 instances (2 masters and 2 slaves).\n\nIn the meantime, I'm staying at 2.3.10 but building a 2.4.x package that's ready to deploy in case it makes sense to upgrade some or all of the instances.\n\nAnd so far this only affects slaves, as I mentioned before.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2435021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2435215","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2435215","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2435215,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzUyMTU=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-17T21:44:40Z","updated_at":"2011-10-17T21:44:40Z","body":"Your earlier question about operations we commonly use.  I can say that we use a lot of ZSETs (most of them are small and stay in the compact representation).  If you have a way I can privately send you some data, I've been re-testing AOF on one of our nodes and could give you a representative sample of a .aof file.  That might be useful (or not).  Feel free to email me directly (Jeremy@Zawodny.com) if you'd like and I can make it available.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2435215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2439914","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2439914","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2439914,"node_id":"MDEyOklzc3VlQ29tbWVudDI0Mzk5MTQ=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-18T10:02:00Z","updated_at":"2011-10-18T10:02:00Z","body":"Hello Jeremy, thank you for your help.\n\nI analyzed the issue and this is my first guess:\n\n1) For some reason the slave client gets into a \"blocking\" state. like when you use BLPOP or alike. So the input is no longer processed.\n2) Because of \"1\" the input buffer reaches the 2 GB of size, that is the limit for an sds string, and segfaults.\n\nFortunately I think that thanks your big Redis installation we can verify if the above is true.\nBasically it takes some time for this to happen I guess, as there is to get 2GB of writes that's not little.\nSo my guess is that if I'm correct checking the Redis slaves with INFO you'll discover some slave that has a `client_biggest_input_buf` that is different megabytes in size (even if it is just 500k there is something wrong).\n\nIf we find such an instance we can start speculating why it is blocked, and the simplest way to check this is perhaps:\n\n```\nCLIENT LIST\n```\n\nThat will provide us with info about the state of the client.\n\nThank you,\nSalvatore\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2439914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2439942","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2439942","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2439942,"node_id":"MDEyOklzc3VlQ29tbWVudDI0Mzk5NDI=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-18T10:05:47Z","updated_at":"2011-10-18T10:05:47Z","body":"p.s. all the above seems somewhat strange as you don't use blocking commands AFAIK, so perhaps I'm completely wrong but currently it's my best guess... so sorry in advance if after the check you'll not find nothing strange about input buffers... ;)\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2439942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2439985","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2439985","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2439985,"node_id":"MDEyOklzc3VlQ29tbWVudDI0Mzk5ODU=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-18T10:10:13Z","updated_at":"2011-10-18T10:10:13Z","body":"Another small remark: that strange output we see in INFO about this huge buffer is not casual, it seems like it is about 2^31 smaller than 2^64. So this is why I was thinking to an overflow or alike...\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2439985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2441320","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2441320","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2441320,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NDEzMjA=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-18T12:58:40Z","updated_at":"2011-10-18T12:58:40Z","body":"Hmm.  OK, I'll do some more poking around and see what I can find.  In fact, I can add that field as a metric to our monitoring system easily so we'll know which servers are acting up (and when).\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2441320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2442050","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2442050","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2442050,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NDIwNTA=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-18T14:05:20Z","updated_at":"2011-10-18T14:05:20Z","body":"Thanks Jeremy, if no one of your slaves have currently an high value I think my hypotesis should be considered non valid and we can start again from scratch...\n\nI'm trying to understand if I can add a few asserts in Redis 2.4.2 that may help us with this issue.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2442050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2445230","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2445230","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2445230,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NDUyMzA=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-18T18:04:03Z","updated_at":"2011-10-18T18:04:03Z","body":"I'm deploying some new monitoring code now so we can collect and watch this value.  If they're increasing on any of our slaves, I should know soon...\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2445230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2445938","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2445938","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2445938,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NDU5Mzg=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-18T19:07:15Z","updated_at":"2011-10-18T19:07:15Z","body":"Great! Thanks.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2445938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2464020","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2464020","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2464020,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NjQwMjA=","user":{"login":"jokea","id":1139782,"node_id":"MDQ6VXNlcjExMzk3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1139782?v=4","gravatar_id":"","url":"https://api.github.com/users/jokea","html_url":"https://github.com/jokea","followers_url":"https://api.github.com/users/jokea/followers","following_url":"https://api.github.com/users/jokea/following{/other_user}","gists_url":"https://api.github.com/users/jokea/gists{/gist_id}","starred_url":"https://api.github.com/users/jokea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jokea/subscriptions","organizations_url":"https://api.github.com/users/jokea/orgs","repos_url":"https://api.github.com/users/jokea/repos","events_url":"https://api.github.com/users/jokea/events{/privacy}","received_events_url":"https://api.github.com/users/jokea/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-20T02:45:58Z","updated_at":"2011-10-20T02:45:58Z","body":"From the info of the first crashed instance, I think it's a master not slave:\nconnected_clients:1^M\nconnected_slaves:1^M\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2464020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jokea","id":1139782,"node_id":"MDQ6VXNlcjExMzk3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1139782?v=4","gravatar_id":"","url":"https://api.github.com/users/jokea","html_url":"https://github.com/jokea","followers_url":"https://api.github.com/users/jokea/followers","following_url":"https://api.github.com/users/jokea/following{/other_user}","gists_url":"https://api.github.com/users/jokea/gists{/gist_id}","starred_url":"https://api.github.com/users/jokea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jokea/subscriptions","organizations_url":"https://api.github.com/users/jokea/orgs","repos_url":"https://api.github.com/users/jokea/repos","events_url":"https://api.github.com/users/jokea/events{/privacy}","received_events_url":"https://api.github.com/users/jokea/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4459183,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0NTkxODM=","url":"https://api.github.com/repos/redis/redis/issues/events/4459183","actor":{"login":"jokea","id":1139782,"node_id":"MDQ6VXNlcjExMzk3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1139782?v=4","gravatar_id":"","url":"https://api.github.com/users/jokea","html_url":"https://github.com/jokea","followers_url":"https://api.github.com/users/jokea/followers","following_url":"https://api.github.com/users/jokea/following{/other_user}","gists_url":"https://api.github.com/users/jokea/gists{/gist_id}","starred_url":"https://api.github.com/users/jokea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jokea/subscriptions","organizations_url":"https://api.github.com/users/jokea/orgs","repos_url":"https://api.github.com/users/jokea/repos","events_url":"https://api.github.com/users/jokea/events{/privacy}","received_events_url":"https://api.github.com/users/jokea/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-10-20T02:45:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2464084","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2464084","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2464084,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NjQwODQ=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-20T02:55:33Z","updated_at":"2011-10-20T02:55:33Z","body":"Good eye!\n\nActually it's a slave of a master in a remote colo.  But it also has a replica in the local colo.  So technically it's both.\n\nDoes that make sense?\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2464084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2464169","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2464169","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2464169,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NjQxNjk=","user":{"login":"jokea","id":1139782,"node_id":"MDQ6VXNlcjExMzk3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1139782?v=4","gravatar_id":"","url":"https://api.github.com/users/jokea","html_url":"https://github.com/jokea","followers_url":"https://api.github.com/users/jokea/followers","following_url":"https://api.github.com/users/jokea/following{/other_user}","gists_url":"https://api.github.com/users/jokea/gists{/gist_id}","starred_url":"https://api.github.com/users/jokea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jokea/subscriptions","organizations_url":"https://api.github.com/users/jokea/orgs","repos_url":"https://api.github.com/users/jokea/repos","events_url":"https://api.github.com/users/jokea/events{/privacy}","received_events_url":"https://api.github.com/users/jokea/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-20T03:10:15Z","updated_at":"2011-10-20T03:10:15Z","body":"If it also acts as a slave, the \"connected_clients:\" should be 2 instead of 1, unless the\nmaster <-> slave link is down when the crash happens.\n\nThis may not related to the crash though.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2464169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jokea","id":1139782,"node_id":"MDQ6VXNlcjExMzk3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1139782?v=4","gravatar_id":"","url":"https://api.github.com/users/jokea","html_url":"https://github.com/jokea","followers_url":"https://api.github.com/users/jokea/followers","following_url":"https://api.github.com/users/jokea/following{/other_user}","gists_url":"https://api.github.com/users/jokea/gists{/gist_id}","starred_url":"https://api.github.com/users/jokea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jokea/subscriptions","organizations_url":"https://api.github.com/users/jokea/orgs","repos_url":"https://api.github.com/users/jokea/repos","events_url":"https://api.github.com/users/jokea/events{/privacy}","received_events_url":"https://api.github.com/users/jokea/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2465472","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2465472","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2465472,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NjU0NzI=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-20T07:07:09Z","updated_at":"2011-10-20T07:07:09Z","body":"oh that's interesting. Jeremy: the other crashing instances were slave and master at the same time too?\n\np.s. I guess so far none of your instance has a client with a big input buffer otherwise your monitoring system would alert you. So probably my first guess is wrong.\n\nThanks for the help\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2465472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2465612","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2465612","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2465612,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NjU2MTI=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-20T07:30:41Z","updated_at":"2011-10-20T07:30:41Z","body":"I'll have a look in the morning to see if the others were masters and slaves--I'm just heading to bed.\n\nOur system has seen some non-zero buffers reported, but they're occasional and only around 8KB in size when we see them.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2465612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2465816","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2465816","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2465816,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NjU4MTY=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-10-20T07:59:34Z","updated_at":"2011-10-20T07:59:34Z","body":"> Our system has seen some non-zero buffers reported, but they're occasional and only around 8KB in size when we see them.\n\nThanks, it's time to look at this issue from another point of view then :) It is hardly what I suggested before.\nSo is a more provincial corruption-alike problem. I hope it is not still in 2.4 even if the version you are using is pretty new.\n\nToday I'll setup some test to try simulating the issue, maybe we are lucky and it is reproducible. Thanks!\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2465816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2789042","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2789042","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2789042,"node_id":"MDEyOklzc3VlQ29tbWVudDI3ODkwNDI=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-11-18T13:30:42Z","updated_at":"2011-11-18T13:30:42Z","body":"Hello Jeremy! I guess that this never happened again since you upgrade since I see no news here, asking just for ACK :) Thank you and have a nice day.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2789042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2796370","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2796370","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2796370,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTYzNzA=","user":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-11-19T00:29:04Z","updated_at":"2011-11-19T00:29:04Z","body":"Actually, we had some of these happen a couple days ago. :-(\n\nBut this time our monitoring system recorded the problem for us:\n\nhttp://dl.dropbox.com/u/6763272/redis-output-buff.png\n\nWe're not sure what triggered that yet, but it definitely makes me suspect some odd network condition.\n\nMeanwhile, all crashed nodes are running 2.4.2 now.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2796370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jzawodn","id":35859,"node_id":"MDQ6VXNlcjM1ODU5","avatar_url":"https://avatars.githubusercontent.com/u/35859?v=4","gravatar_id":"","url":"https://api.github.com/users/jzawodn","html_url":"https://github.com/jzawodn","followers_url":"https://api.github.com/users/jzawodn/followers","following_url":"https://api.github.com/users/jzawodn/following{/other_user}","gists_url":"https://api.github.com/users/jzawodn/gists{/gist_id}","starred_url":"https://api.github.com/users/jzawodn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzawodn/subscriptions","organizations_url":"https://api.github.com/users/jzawodn/orgs","repos_url":"https://api.github.com/users/jzawodn/repos","events_url":"https://api.github.com/users/jzawodn/events{/privacy}","received_events_url":"https://api.github.com/users/jzawodn/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2798640","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2798640","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2798640,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTg2NDA=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-11-19T12:46:27Z","updated_at":"2011-11-19T12:46:46Z","body":"Hi Jeremy! It seems like the mystery is no longer a mystery :)\n\nFacts:\n- The graph you provide is a proof that my early concepture was right: this is an overflow on sds reaching 2GB in size.\n- The overflowing sds buffer is the output buffer, so the crashing Redis instance is not able to send data, or to send data at the same speed as this data should be received by the client.\n\nWhen Redis can't send data to clients? There are multiple possibilities:\n- There is a networking problem.\n- A client simply crashed or is blocked into a dead lock of some kind, without closing the connection, but it still should receive data continuously (for instance because it is subscribed to a Pub/Sub channel). Such a client can be a Redis slave, that is a special kind of slave that continuously receives writes.\n- For a bug we removed the write handler from the client file descriptor. Never happened before, but it is a possible cause in theory.\n\nSo Redis will write to the client input buffer, however no data is removed from the buffer since there is some problem either in the client not reading the data, or in the network that silently discards our packets without replying with a TCP reset packet closing our connection. At some point the sds length overflows and the server crashes.\n\nWhy this is particularly likely to happen with slaves? Because we only have timeout detection in the slave. The master does not understand when a slave is not available. We introduced pings and alike only from the point of view of the slave since it was much more important for the slave to detect it was no longer receiving fresh data from the master, to close the old connection and reconnect.\n\nSo what to do?\n\nThe first thing to fix this bug, or at least the _effect_ of this bug, is to close the connection when the input buffer of a client reaches a given big size, like 1GB or alike. This will prevent the crash. I'll commit such a change monday at max and will release a new version of Redis stable.\n\nBut it is possible to argue that this only fixes the effect and not the cause, and that a proper fix would require timeout detection in the master -> slave link also from the point of view of the master, and not just the slave.\n\nJeremy: if we are near to a solution is thanks to your help, Thanks You!\nI really don't like when we have open bugs of this kind... and often the only way we can get enough context to understand what is happening is thanks to information that the user experiencing the bug can collect and provide.\nFor instance in this case your mention of a possible network issue was very important to move the right bells...\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2798640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2815370","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2815370","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2815370,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MTUzNzA=","user":{"login":"Annih","id":559627,"node_id":"MDQ6VXNlcjU1OTYyNw==","avatar_url":"https://avatars.githubusercontent.com/u/559627?v=4","gravatar_id":"","url":"https://api.github.com/users/Annih","html_url":"https://github.com/Annih","followers_url":"https://api.github.com/users/Annih/followers","following_url":"https://api.github.com/users/Annih/following{/other_user}","gists_url":"https://api.github.com/users/Annih/gists{/gist_id}","starred_url":"https://api.github.com/users/Annih/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Annih/subscriptions","organizations_url":"https://api.github.com/users/Annih/orgs","repos_url":"https://api.github.com/users/Annih/repos","events_url":"https://api.github.com/users/Annih/events{/privacy}","received_events_url":"https://api.github.com/users/Annih/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-11-21T14:00:57Z","updated_at":"2011-11-21T14:00:57Z","body":"Hi Antirez and Jeremy!\n\nToday we faced the same problem on one slave of our prod environment only few minutes after it start:\n\n<pre>\n[14532] 21 Nov 11:49:40 # ======= Ooops! Redis 2.4.2 got signal: -11- =======\n[14532] 21 Nov 11:49:40 # redis_version:2.4.2\nredis_git_sha1:00000000\nredis_git_dirty:0\narch_bits:64\nmultiplexing_api:epoll\nprocess_id:14532\nuptime_in_seconds:2385\nuptime_in_days:0\nlru_clock:67042\nused_cpu_sys:127.59\nused_cpu_user:44.75\nused_cpu_sys_children:4.84\nused_cpu_user_children:1.77\nconnected_clients:20\nconnected_slaves:0\nclient_longest_output_list:0\nclient_biggest_input_buf:18446744071562068563\nblocked_clients:0\nused_memory:31861605448\nused_memory_human:29.67G\nused_memory_rss:30233288704\nused_memory_peak:31861605448\nused_memory_peak_human:29.67G\nmem_fragmentation_ratio:0.95\nmem_allocator:jemalloc-2.2.1\nloading:0\naof_enabled:0\nchanges_since_last_save:60\nbgsave_in_progress:0\nlast_save_time:1321873795\nbgrewriteaof_in_progress:0\ntotal_connections_received:119\ntotal_commands_processed:237\nexpired_keys:0\nevicted_keys:0\nkeyspace_hits:278\nkeyspace_misses:23\npubsub_channels:0\npubsub_patterns:0\nlatest_fork_usec:3429217\nvm_enabled:0\nrole:slave\nmaster_host: \nmaster_port:6379\nmaster_\n[14532] 21 Nov 11:49:40 # /lib/libc.so.6(memcpy+0xe1) [0x2aaaab3e7fb1]\n[14532] 21 Nov 11:49:40 # /lib/libc.so.6(memcpy+0xe1) [0x2aaaab3e7fb1]\n[14532] 21 Nov 11:49:40 # redis-server(sdscatlen+0x54) [0x412fe4]\n[14532] 21 Nov 11:49:40 # redis-server(readQueryFromClient+0x33) [0x419293]\n[14532] 21 Nov 11:49:40 # redis-server(aeProcessEvents+0x16e) [0x40d35e]\n[14532] 21 Nov 11:49:40 # redis-server(aeMain+0x2e) [0x40d57e]\n[14532] 21 Nov 11:49:40 # redis-server(main+0xf9) [0x4127d9]\n[14532] 21 Nov 11:49:40 # /lib/libc.so.6(__libc_start_main+0xe6) [0x2aaaab3895a6]\n[14532] 21 Nov 11:49:40 # redis-server [0x40c869]\n</pre>\n\n\nAs the crash log shows:\n- We are using Redis 2.4.2.\n- This instance was only a slave (it might have recieved some \"SET\" command from some clients).\n- The input buffer seems to be huge too ^^\n\nI don't know if it can help you, but unlike Jeremy, we are not using ZSet, and we didn't have any monitoring tools on that slave.\nDo not hesitate to ask me if you have any questions about our redis setup.\n\nRegards,\n\nBaptiste.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2815370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Annih","id":559627,"node_id":"MDQ6VXNlcjU1OTYyNw==","avatar_url":"https://avatars.githubusercontent.com/u/559627?v=4","gravatar_id":"","url":"https://api.github.com/users/Annih","html_url":"https://github.com/Annih","followers_url":"https://api.github.com/users/Annih/followers","following_url":"https://api.github.com/users/Annih/following{/other_user}","gists_url":"https://api.github.com/users/Annih/gists{/gist_id}","starred_url":"https://api.github.com/users/Annih/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Annih/subscriptions","organizations_url":"https://api.github.com/users/Annih/orgs","repos_url":"https://api.github.com/users/Annih/repos","events_url":"https://api.github.com/users/Annih/events{/privacy}","received_events_url":"https://api.github.com/users/Annih/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5682333,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDU2ODIzMzM=","url":"https://api.github.com/repos/redis/redis/issues/events/5682333","actor":{"login":"Annih","id":559627,"node_id":"MDQ6VXNlcjU1OTYyNw==","avatar_url":"https://avatars.githubusercontent.com/u/559627?v=4","gravatar_id":"","url":"https://api.github.com/users/Annih","html_url":"https://github.com/Annih","followers_url":"https://api.github.com/users/Annih/followers","following_url":"https://api.github.com/users/Annih/following{/other_user}","gists_url":"https://api.github.com/users/Annih/gists{/gist_id}","starred_url":"https://api.github.com/users/Annih/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Annih/subscriptions","organizations_url":"https://api.github.com/users/Annih/orgs","repos_url":"https://api.github.com/users/Annih/repos","events_url":"https://api.github.com/users/Annih/events{/privacy}","received_events_url":"https://api.github.com/users/Annih/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-11-21T14:00:57Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2815592","html_url":"https://github.com/redis/redis/issues/141#issuecomment-2815592","issue_url":"https://api.github.com/repos/redis/redis/issues/141","id":2815592,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MTU1OTI=","user":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-11-21T14:19:24Z","updated_at":"2011-11-21T14:19:24Z","body":"Thanks this is definitely the same bug, but the fact that it is just a slave makes things a bit different.\nAlso it does not help that Redis truncates INFO outputs in stack traces... (fixing that as well, already fixed into unstable).\n\nBtw the changes I'm doing should provide a lot more background when the input or output buffer overflows... doing the changes right now. I'll update this issue soon.\n\nBtw in my reasoning early in this thread I completely missed that even in the Jeremy case the overflow is happening in the INPUT buffer of the client and not in the output buffer, this changes a few things...\n\nMore news soon.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2815592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}}]