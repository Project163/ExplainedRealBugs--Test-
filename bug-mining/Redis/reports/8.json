{"url":"https://api.github.com/repos/redis/redis/issues/516","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/516/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/516/comments","events_url":"https://api.github.com/repos/redis/redis/issues/516/events","html_url":"https://github.com/redis/redis/issues/516","id":4702654,"node_id":"MDU6SXNzdWU0NzAyNjU0","number":516,"title":"zinterstore fails when mixing sets and sorted sets","user":{"login":"atanivist","id":1767603,"node_id":"MDQ6VXNlcjE3Njc2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/1767603?v=4","gravatar_id":"","url":"https://api.github.com/users/atanivist","html_url":"https://github.com/atanivist","followers_url":"https://api.github.com/users/atanivist/followers","following_url":"https://api.github.com/users/atanivist/following{/other_user}","gists_url":"https://api.github.com/users/atanivist/gists{/gist_id}","starred_url":"https://api.github.com/users/atanivist/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atanivist/subscriptions","organizations_url":"https://api.github.com/users/atanivist/orgs","repos_url":"https://api.github.com/users/atanivist/repos","events_url":"https://api.github.com/users/atanivist/events{/privacy}","received_events_url":"https://api.github.com/users/atanivist/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":155760,"node_id":"MDU6TGFiZWwxNTU3NjA=","url":"https://api.github.com/repos/redis/redis/labels/critical%20bug","name":"critical bug","color":"e10c02","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/redis/redis/milestones/1","html_url":"https://github.com/redis/redis/milestone/1","labels_url":"https://api.github.com/repos/redis/redis/milestones/1/labels","id":38963,"node_id":"MDk6TWlsZXN0b25lMzg5NjM=","number":1,"title":"Redis 2.6","description":"Redis 2.6, first version of Redis with scripting support.","creator":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":75,"state":"closed","created_at":"2011-09-20T12:59:46Z","updated_at":"2014-12-11T14:54:39Z","due_on":null,"closed_at":"2012-10-05T09:21:16Z"},"comments":2,"created_at":"2012-05-23T00:10:06Z","updated_at":"2012-06-05T06:51:59Z","closed_at":"2012-06-05T06:51:59Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I have two sets and a single sorted set and I'm trying to use zinterstore to get the scored intersection of all three.  The operation is failing with my production data but succeeding if I substitute a test sorted set it works in some cases but not all and I'm stumped about why.\n\nTo setup the test, add three entries to set \"one\", four entries to set \"two\" - including a signle entry that exists in set \"one\", and four entries in the sorted set - including that same single entry from set \"one\"\n\n```\nsadd one 100 101 102 103 \nsadd two 100 200 201 202\nzadd three 1 500 1 501 1 502 1 503 1 100\n```\n\nNow if you run\n\n```\nzinterstore to_here 3 one two three WEIGHTS 0 0 1\n```\n\nNothing is found to intersect.\n\nCreate a new sort set \"four\":\n\n```\nzadd four 1 600 1 100 \n\nzinterstore to_here 3 one two four WEIGHTS 0 0 1\n```\n\nThere is an intersection on the entry 100!\n\nMy production data isn't so simple but I'm seeing the same result, some intersections appear to work, at least in part, but others fail completely.\n\nThis happens on redis versions 2.4.13 and the latest 2.6 RC.\n\nJosiah Carlson kindly tested this and found that it behaves correctly in earlier versions of redis:\n\n> Testing against Redis 2.4.1, 2.4.7, 2.4.10 your intersection works for me. \n> Testing against Redis 2.4.13 however, fails. \n","closed_by":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/redis/redis/issues/516/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/516/timeline","performed_via_github_app":null,"state_reason":"completed"}