[{"id":13117201739,"node_id":"LE_lADOAAJhcs6L2uBEzwAAAAMN2J1L","url":"https://api.github.com/repos/redis/redis/issues/events/13117201739","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-06-11T13:22:56Z","label":{"name":"streams","color":"f98918"},"performed_via_github_app":null},{"id":13117202958,"node_id":"LE_lADOAAJhcs6L2uBEzwAAAAMN2KIO","url":"https://api.github.com/repos/redis/redis/issues/events/13117202958","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-06-11T13:23:01Z","label":{"name":"class:bug","color":"a0ce44"},"performed_via_github_app":null},{"actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-12T07:20:18Z","updated_at":"2024-06-12T07:20:18Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/redis/redis/issues/13338","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/13338/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/13338/comments","events_url":"https://api.github.com/repos/redis/redis/issues/13338/events","html_url":"https://github.com/redis/redis/pull/13338","id":2348013995,"node_id":"PR_kwDOAAJhcs5yMlCY","number":13338,"title":"Fix incorrect lag field in XINFO when tombstone is after the last_id of consume group","user":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2219859425,"node_id":"MDU6TGFiZWwyMjE5ODU5NDI1","url":"https://api.github.com/repos/redis/redis/labels/release-notes","name":"release-notes","color":"b60205","default":false,"description":"indication that this issue needs to be mentioned in the release notes"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-06-12T07:20:18Z","updated_at":"2025-01-08T01:37:45Z","closed_at":"2024-07-30T14:31:31Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":156018,"node_id":"MDEwOlJlcG9zaXRvcnkxNTYwMTg=","name":"redis","full_name":"redis/redis","private":false,"owner":{"login":"redis","id":1529926,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1Mjk5MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1529926?v=4","gravatar_id":"","url":"https://api.github.com/users/redis","html_url":"https://github.com/redis","followers_url":"https://api.github.com/users/redis/followers","following_url":"https://api.github.com/users/redis/following{/other_user}","gists_url":"https://api.github.com/users/redis/gists{/gist_id}","starred_url":"https://api.github.com/users/redis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/redis/subscriptions","organizations_url":"https://api.github.com/users/redis/orgs","repos_url":"https://api.github.com/users/redis/repos","events_url":"https://api.github.com/users/redis/events{/privacy}","received_events_url":"https://api.github.com/users/redis/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/redis/redis","description":"For developers, who are building real-time data-driven applications, Redis is the preferred, fastest, and most feature-rich cache, data structure server, and document and vector query engine.","fork":false,"url":"https://api.github.com/repos/redis/redis","forks_url":"https://api.github.com/repos/redis/redis/forks","keys_url":"https://api.github.com/repos/redis/redis/keys{/key_id}","collaborators_url":"https://api.github.com/repos/redis/redis/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/redis/redis/teams","hooks_url":"https://api.github.com/repos/redis/redis/hooks","issue_events_url":"https://api.github.com/repos/redis/redis/issues/events{/number}","events_url":"https://api.github.com/repos/redis/redis/events","assignees_url":"https://api.github.com/repos/redis/redis/assignees{/user}","branches_url":"https://api.github.com/repos/redis/redis/branches{/branch}","tags_url":"https://api.github.com/repos/redis/redis/tags","blobs_url":"https://api.github.com/repos/redis/redis/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/redis/redis/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/redis/redis/git/refs{/sha}","trees_url":"https://api.github.com/repos/redis/redis/git/trees{/sha}","statuses_url":"https://api.github.com/repos/redis/redis/statuses/{sha}","languages_url":"https://api.github.com/repos/redis/redis/languages","stargazers_url":"https://api.github.com/repos/redis/redis/stargazers","contributors_url":"https://api.github.com/repos/redis/redis/contributors","subscribers_url":"https://api.github.com/repos/redis/redis/subscribers","subscription_url":"https://api.github.com/repos/redis/redis/subscription","commits_url":"https://api.github.com/repos/redis/redis/commits{/sha}","git_commits_url":"https://api.github.com/repos/redis/redis/git/commits{/sha}","comments_url":"https://api.github.com/repos/redis/redis/comments{/number}","issue_comment_url":"https://api.github.com/repos/redis/redis/issues/comments{/number}","contents_url":"https://api.github.com/repos/redis/redis/contents/{+path}","compare_url":"https://api.github.com/repos/redis/redis/compare/{base}...{head}","merges_url":"https://api.github.com/repos/redis/redis/merges","archive_url":"https://api.github.com/repos/redis/redis/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/redis/redis/downloads","issues_url":"https://api.github.com/repos/redis/redis/issues{/number}","pulls_url":"https://api.github.com/repos/redis/redis/pulls{/number}","milestones_url":"https://api.github.com/repos/redis/redis/milestones{/number}","notifications_url":"https://api.github.com/repos/redis/redis/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/redis/redis/labels{/name}","releases_url":"https://api.github.com/repos/redis/redis/releases{/id}","deployments_url":"https://api.github.com/repos/redis/redis/deployments","created_at":"2009-03-21T22:32:25Z","updated_at":"2025-12-13T04:51:44Z","pushed_at":"2025-12-11T09:07:47Z","git_url":"git://github.com/redis/redis.git","ssh_url":"git@github.com:redis/redis.git","clone_url":"https://github.com/redis/redis.git","svn_url":"https://github.com/redis/redis","homepage":"http://redis.io","size":205841,"stargazers_count":72116,"watchers_count":72116,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":24380,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2735,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["cache","caching","database","distributed-systems","in-memory","in-memory-database","json","key-value","key-value-store","message-broker","message-queue","no-sql","nosql","open-source","real-time","realtime","redis","time-series","vector-databases","vector-search"],"visibility":"public","forks":24380,"open_issues":2735,"watchers":72116,"default_branch":"unstable","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/redis/redis/pulls/13338","html_url":"https://github.com/redis/redis/pull/13338","diff_url":"https://github.com/redis/redis/pull/13338.diff","patch_url":"https://github.com/redis/redis/pull/13338.patch","merged_at":"2024-07-30T14:31:31Z"},"body":"Fix #13337\r\n\r\nThs PR fixes fixed two bugs that caused lag calculation errors.\r\n1. When the latest tombstone is before the first entry, the tombstone may stil be after the last id of consume group.\r\n2. When a tombstone is after the last id of consume group, the group's counter will be invalid, we should caculate the entries_read by using estimates.","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/13338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/13338/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2162310469","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2162310469","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2162310469,"node_id":"IC_kwDOAAJhcs6A4j1F","user":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-12T07:32:48Z","updated_at":"2024-06-12T07:32:48Z","body":"@sancar thanks, this will be fixed in #13338, do you want a try?","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2162310469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13127281521,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMOcmtx","url":"https://api.github.com/repos/redis/redis/issues/events/13127281521","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-12T07:32:50Z","performed_via_github_app":null},{"id":13127281531,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMOcmt7","url":"https://api.github.com/repos/redis/redis/issues/events/13127281531","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-12T07:32:50Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2162387812","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2162387812","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2162387812,"node_id":"IC_kwDOAAJhcs6A42tk","user":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-12T08:15:02Z","updated_at":"2024-06-12T08:15:02Z","body":"Sure @sundb , I will try. ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2162387812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13127829418,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMOeseq","url":"https://api.github.com/repos/redis/redis/issues/events/13127829418","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-12T08:15:04Z","performed_via_github_app":null},{"id":13127829433,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMOese5","url":"https://api.github.com/repos/redis/redis/issues/events/13127829433","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-12T08:15:04Z","performed_via_github_app":null},{"actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-12T18:33:35Z","updated_at":"2024-06-12T18:33:35Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/alicebob/miniredis/issues/377","repository_url":"https://api.github.com/repos/alicebob/miniredis","labels_url":"https://api.github.com/repos/alicebob/miniredis/issues/377/labels{/name}","comments_url":"https://api.github.com/repos/alicebob/miniredis/issues/377/comments","events_url":"https://api.github.com/repos/alicebob/miniredis/issues/377/events","html_url":"https://github.com/alicebob/miniredis/pull/377","id":2338337619,"node_id":"PR_kwDOAWiAmc5xr5HZ","number":377,"title":"Fix Stream Lag and Add EntriesAdded/EntriesRead","user":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2024-06-06T13:57:32Z","updated_at":"2024-06-12T18:33:36Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"repository":{"id":23625881,"node_id":"MDEwOlJlcG9zaXRvcnkyMzYyNTg4MQ==","name":"miniredis","full_name":"alicebob/miniredis","private":false,"owner":{"login":"alicebob","id":621306,"node_id":"MDQ6VXNlcjYyMTMwNg==","avatar_url":"https://avatars.githubusercontent.com/u/621306?v=4","gravatar_id":"","url":"https://api.github.com/users/alicebob","html_url":"https://github.com/alicebob","followers_url":"https://api.github.com/users/alicebob/followers","following_url":"https://api.github.com/users/alicebob/following{/other_user}","gists_url":"https://api.github.com/users/alicebob/gists{/gist_id}","starred_url":"https://api.github.com/users/alicebob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alicebob/subscriptions","organizations_url":"https://api.github.com/users/alicebob/orgs","repos_url":"https://api.github.com/users/alicebob/repos","events_url":"https://api.github.com/users/alicebob/events{/privacy}","received_events_url":"https://api.github.com/users/alicebob/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/alicebob/miniredis","description":"Pure Go Redis server for Go unittests","fork":false,"url":"https://api.github.com/repos/alicebob/miniredis","forks_url":"https://api.github.com/repos/alicebob/miniredis/forks","keys_url":"https://api.github.com/repos/alicebob/miniredis/keys{/key_id}","collaborators_url":"https://api.github.com/repos/alicebob/miniredis/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/alicebob/miniredis/teams","hooks_url":"https://api.github.com/repos/alicebob/miniredis/hooks","issue_events_url":"https://api.github.com/repos/alicebob/miniredis/issues/events{/number}","events_url":"https://api.github.com/repos/alicebob/miniredis/events","assignees_url":"https://api.github.com/repos/alicebob/miniredis/assignees{/user}","branches_url":"https://api.github.com/repos/alicebob/miniredis/branches{/branch}","tags_url":"https://api.github.com/repos/alicebob/miniredis/tags","blobs_url":"https://api.github.com/repos/alicebob/miniredis/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/alicebob/miniredis/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/alicebob/miniredis/git/refs{/sha}","trees_url":"https://api.github.com/repos/alicebob/miniredis/git/trees{/sha}","statuses_url":"https://api.github.com/repos/alicebob/miniredis/statuses/{sha}","languages_url":"https://api.github.com/repos/alicebob/miniredis/languages","stargazers_url":"https://api.github.com/repos/alicebob/miniredis/stargazers","contributors_url":"https://api.github.com/repos/alicebob/miniredis/contributors","subscribers_url":"https://api.github.com/repos/alicebob/miniredis/subscribers","subscription_url":"https://api.github.com/repos/alicebob/miniredis/subscription","commits_url":"https://api.github.com/repos/alicebob/miniredis/commits{/sha}","git_commits_url":"https://api.github.com/repos/alicebob/miniredis/git/commits{/sha}","comments_url":"https://api.github.com/repos/alicebob/miniredis/comments{/number}","issue_comment_url":"https://api.github.com/repos/alicebob/miniredis/issues/comments{/number}","contents_url":"https://api.github.com/repos/alicebob/miniredis/contents/{+path}","compare_url":"https://api.github.com/repos/alicebob/miniredis/compare/{base}...{head}","merges_url":"https://api.github.com/repos/alicebob/miniredis/merges","archive_url":"https://api.github.com/repos/alicebob/miniredis/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/alicebob/miniredis/downloads","issues_url":"https://api.github.com/repos/alicebob/miniredis/issues{/number}","pulls_url":"https://api.github.com/repos/alicebob/miniredis/pulls{/number}","milestones_url":"https://api.github.com/repos/alicebob/miniredis/milestones{/number}","notifications_url":"https://api.github.com/repos/alicebob/miniredis/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/alicebob/miniredis/labels{/name}","releases_url":"https://api.github.com/repos/alicebob/miniredis/releases{/id}","deployments_url":"https://api.github.com/repos/alicebob/miniredis/deployments","created_at":"2014-09-03T15:24:50Z","updated_at":"2025-12-09T14:52:20Z","pushed_at":"2025-11-12T08:33:47Z","git_url":"git://github.com/alicebob/miniredis.git","ssh_url":"git@github.com:alicebob/miniredis.git","clone_url":"https://github.com/alicebob/miniredis.git","svn_url":"https://github.com/alicebob/miniredis","homepage":"","size":1167,"stargazers_count":3422,"watchers_count":3422,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":238,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":8,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["go","redis","unittest"],"visibility":"public","forks":238,"open_issues":8,"watchers":3422,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/alicebob/miniredis/pulls/377","html_url":"https://github.com/alicebob/miniredis/pull/377","diff_url":"https://github.com/alicebob/miniredis/pull/377.diff","patch_url":"https://github.com/alicebob/miniredis/pull/377.patch","merged_at":null},"body":"Added them according to redis spec described here\r\nhttps://redis.io/docs/latest/commands/xinfo-groups/","reactions":{"url":"https://api.github.com/repos/alicebob/miniredis/issues/377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/alicebob/miniredis/issues/377/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2164230575","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2164230575","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2164230575,"node_id":"IC_kwDOAAJhcs6A_4mv","user":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-13T02:23:32Z","updated_at":"2024-06-13T02:23:32Z","body":"@sancar sorry, i realize that the fix in https://github.com/redis/redis/pull/13338 is totally wrong.\r\nin your case, the max deleted id is before the first entry of the stream, so the lag is calculated by using `s->entries_added - s->length`.\r\nplease wait for the opinion from @itamarhaber.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2164230575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13139394831,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMPK0EP","url":"https://api.github.com/repos/redis/redis/issues/events/13139394831","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-13T02:23:34Z","performed_via_github_app":null},{"id":13139394834,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMPK0ES","url":"https://api.github.com/repos/redis/redis/issues/events/13139394834","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-13T02:23:34Z","performed_via_github_app":null},{"id":13139394843,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMPK0Eb","url":"https://api.github.com/repos/redis/redis/issues/events/13139394843","actor":{"login":"itamarhaber","id":6059516,"node_id":"MDQ6VXNlcjYwNTk1MTY=","avatar_url":"https://avatars.githubusercontent.com/u/6059516?v=4","gravatar_id":"","url":"https://api.github.com/users/itamarhaber","html_url":"https://github.com/itamarhaber","followers_url":"https://api.github.com/users/itamarhaber/followers","following_url":"https://api.github.com/users/itamarhaber/following{/other_user}","gists_url":"https://api.github.com/users/itamarhaber/gists{/gist_id}","starred_url":"https://api.github.com/users/itamarhaber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itamarhaber/subscriptions","organizations_url":"https://api.github.com/users/itamarhaber/orgs","repos_url":"https://api.github.com/users/itamarhaber/repos","events_url":"https://api.github.com/users/itamarhaber/events{/privacy}","received_events_url":"https://api.github.com/users/itamarhaber/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-13T02:23:34Z","performed_via_github_app":null},{"id":13139394847,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMPK0Ef","url":"https://api.github.com/repos/redis/redis/issues/events/13139394847","actor":{"login":"itamarhaber","id":6059516,"node_id":"MDQ6VXNlcjYwNTk1MTY=","avatar_url":"https://avatars.githubusercontent.com/u/6059516?v=4","gravatar_id":"","url":"https://api.github.com/users/itamarhaber","html_url":"https://github.com/itamarhaber","followers_url":"https://api.github.com/users/itamarhaber/followers","following_url":"https://api.github.com/users/itamarhaber/following{/other_user}","gists_url":"https://api.github.com/users/itamarhaber/gists{/gist_id}","starred_url":"https://api.github.com/users/itamarhaber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itamarhaber/subscriptions","organizations_url":"https://api.github.com/users/itamarhaber/orgs","repos_url":"https://api.github.com/users/itamarhaber/repos","events_url":"https://api.github.com/users/itamarhaber/events{/privacy}","received_events_url":"https://api.github.com/users/itamarhaber/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-13T02:23:34Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2164541311","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2164541311","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2164541311,"node_id":"IC_kwDOAAJhcs6BBEd_","user":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-13T06:12:16Z","updated_at":"2024-06-13T06:21:00Z","body":"My tests seem to be all passing now. \r\nCan you also clarify when `entries-read` should be nil ? Redis seems to be returning `Nil` for it sometimes but documentation is not clear on that. ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2164541311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2164576670","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2164576670","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2164576670,"node_id":"IC_kwDOAAJhcs6BBNGe","user":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-13T06:22:34Z","updated_at":"2024-06-13T06:22:34Z","body":"@sancar actually, the root cause is the last id of consume group is before the max deleted id, and the first id of stream is after the max deleted id at the same time.\r\nalthought this fix works, i'm still concerned about if it may bring some side effects.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2164576670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13140969245,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMPQ0cd","url":"https://api.github.com/repos/redis/redis/issues/events/13140969245","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-13T06:22:36Z","performed_via_github_app":null},{"id":13140969265,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMPQ0cx","url":"https://api.github.com/repos/redis/redis/issues/events/13140969265","actor":{"login":"sancar","id":570462,"node_id":"MDQ6VXNlcjU3MDQ2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/570462?v=4","gravatar_id":"","url":"https://api.github.com/users/sancar","html_url":"https://github.com/sancar","followers_url":"https://api.github.com/users/sancar/followers","following_url":"https://api.github.com/users/sancar/following{/other_user}","gists_url":"https://api.github.com/users/sancar/gists{/gist_id}","starred_url":"https://api.github.com/users/sancar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sancar/subscriptions","organizations_url":"https://api.github.com/users/sancar/orgs","repos_url":"https://api.github.com/users/sancar/repos","events_url":"https://api.github.com/users/sancar/events{/privacy}","received_events_url":"https://api.github.com/users/sancar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-13T06:22:36Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2184093168","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2184093168","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2184093168,"node_id":"IC_kwDOAAJhcs6CLp3w","user":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T16:37:37Z","updated_at":"2024-06-22T16:37:37Z","body":"I think there are inherent issues with this design. entries_read depends on the value of max_deleted_entry_id, which indicates that entries read is related to the order of xread and xdel. For example, the following example:\r\n\r\n```\r\n    test {Consumer group lag with with tombstone V1} {\r\n        r DEL x\r\n        r XGROUP CREATE x processing $ MKSTREAM\r\n        r XGROUP CREATE x processing1 $ MKSTREAM\r\n        r XADD x 0-1 name Mercury\r\n        r XADD x 0-2 name Venus\r\n        r XADD x 0-3 name Earth\r\n        r XADD x 0-4 name Jupiter\r\n\r\n        r XREADGROUP GROUP processing alice COUNT 2 STREAMS x >\r\n        r XDEL x 0-3\r\n\r\n        set reply [r XINFO STREAM x FULL]\r\n        set group [lindex [dict get $reply groups] 0]\r\n        assert_equal [dict get $group entries-read] 2\r\n    }\r\n\r\n    test {Consumer group lag with with tombstone V2} {\r\n        r DEL x\r\n        r XGROUP CREATE x processing $ MKSTREAM\r\n        r XGROUP CREATE x processing1 $ MKSTREAM\r\n        r XADD x 0-1 name Mercury\r\n        r XADD x 0-2 name Venus\r\n        r XADD x 0-3 name Earth\r\n        r XADD x 0-4 name Jupiter\r\n\r\n        r XDEL x 0-3\r\n        r XREADGROUP GROUP processing alice COUNT 2 STREAMS x >\r\n\r\n        set reply [r XINFO STREAM x FULL]\r\n        set group [lindex [dict get $reply groups] 0]\r\n        assert_equal [dict get $group entries-read] 2\r\n    }\r\n```\r\n\r\nThe second case will fail. I think this is not in line with expectations. Here, we cannot generate data for lag and entries_read without relying on max_deleted_entry_id.\r\n\r\nWhat do you think? @sundb ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2184093168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13251076283,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMV02C7","url":"https://api.github.com/repos/redis/redis/issues/events/13251076283","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-22T16:37:38Z","performed_via_github_app":null},{"id":13251076286,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMV02C-","url":"https://api.github.com/repos/redis/redis/issues/events/13251076286","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-22T16:37:38Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2184310888","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2184310888","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2184310888,"node_id":"IC_kwDOAAJhcs6CMfBo","user":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-23T01:30:03Z","updated_at":"2024-06-23T01:32:49Z","body":"@artikell please note the last line in the document:\r\n```\r\nIn both cases, the group's read counter is considered invalid, and the returned value is set to NULL to signal that the lag isn't currently available.\r\n```\r\nfor stream, he has forgotten `0-1` and `0-2` after running `r XREADGROUP GROUP processing alice COUNT 2 STREAMS x >`, so we can't calculate the `entries_read` reply on our memory.\r\nin short, the stream group can only calculate the entries-read at the current position.\r\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2184310888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13252293429,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMV5fM1","url":"https://api.github.com/repos/redis/redis/issues/events/13252293429","actor":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-23T01:30:04Z","performed_via_github_app":null},{"id":13252293431,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMV5fM3","url":"https://api.github.com/repos/redis/redis/issues/events/13252293431","actor":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-23T01:30:04Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2185470224","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2185470224","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2185470224,"node_id":"IC_kwDOAAJhcs6CQ6EQ","user":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T02:26:02Z","updated_at":"2024-06-24T02:26:02Z","body":"> @artikell please note the last line in the document:\r\n> \r\n> ```\r\n> In both cases, the group's read counter is considered invalid, and the returned value is set to NULL to signal that the lag isn't currently available.\r\n> ```\r\n> \r\n> for stream, he has forgotten `0-1` and `0-2` after running `r XREADGROUP GROUP processing alice COUNT 2 STREAMS x >`, so we can't calculate the `entries_read` reply on our memory. in short, the stream group can only calculate the entries-read at the current position.\r\n\r\nI understand this issue, but should Redis ensure consistency between entries read and lag. When the lag is invalid, entries read is displayed as valid. This is very confusing.\r\nIn Xinfo, the result of entries read depends on the execution order of xread, while lag does not.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2185470224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13259197148,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMWT0rc","url":"https://api.github.com/repos/redis/redis/issues/events/13259197148","actor":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-24T02:26:03Z","performed_via_github_app":null},{"id":13259197153,"node_id":"SE_lADOAAJhcs6L2uBEzwAAAAMWT0rh","url":"https://api.github.com/repos/redis/redis/issues/events/13259197153","actor":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-06-24T02:26:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/2185477800","html_url":"https://github.com/redis/redis/issues/13337#issuecomment-2185477800","issue_url":"https://api.github.com/repos/redis/redis/issues/13337","id":2185477800,"node_id":"IC_kwDOAAJhcs6CQ76o","user":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T02:36:32Z","updated_at":"2024-06-24T02:36:32Z","body":"@artikell thanks, i've been thinking about this too.\r\nthere is actually a way to ensure that `entries_read` always valid, it always reply on xreadgroup command.\r\ni'm busy elsewhere now, need some time.\r\nperhaps you'd like to fix it based on my PR: https://github.com/redis/redis/pull/13338.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/2185477800/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13259249441,"node_id":"MEE_lADOAAJhcs6L2uBEzwAAAAMWUBch","url":"https://api.github.com/repos/redis/redis/issues/events/13259249441","actor":{"login":"artikell","id":8474552,"node_id":"MDQ6VXNlcjg0NzQ1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/8474552?v=4","gravatar_id":"","url":"https://api.github.com/users/artikell","html_url":"https://github.com/artikell","followers_url":"https://api.github.com/users/artikell/followers","following_url":"https://api.github.com/users/artikell/following{/other_user}","gists_url":"https://api.github.com/users/artikell/gists{/gist_id}","starred_url":"https://api.github.com/users/artikell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artikell/subscriptions","organizations_url":"https://api.github.com/users/artikell/orgs","repos_url":"https://api.github.com/users/artikell/repos","events_url":"https://api.github.com/users/artikell/events{/privacy}","received_events_url":"https://api.github.com/users/artikell/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-06-24T02:36:33Z","performed_via_github_app":null}]