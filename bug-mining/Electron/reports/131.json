{"url":"https://api.github.com/repos/electron/electron/issues/42336","repository_url":"https://api.github.com/repos/electron/electron","labels_url":"https://api.github.com/repos/electron/electron/issues/42336/labels{/name}","comments_url":"https://api.github.com/repos/electron/electron/issues/42336/comments","events_url":"https://api.github.com/repos/electron/electron/issues/42336/events","html_url":"https://github.com/electron/electron/issues/42336","id":2328690703,"node_id":"I_kwDOAI8xS86KzQAP","number":42336,"title":"[Bug]: Setting vibrancy on macOS breaks click events on WebContentsView in Electron 31","user":{"login":"Hans-Halverson","id":17801728,"node_id":"MDQ6VXNlcjE3ODAxNzI4","avatar_url":"https://avatars.githubusercontent.com/u/17801728?v=4","gravatar_id":"","url":"https://api.github.com/users/Hans-Halverson","html_url":"https://github.com/Hans-Halverson","followers_url":"https://api.github.com/users/Hans-Halverson/followers","following_url":"https://api.github.com/users/Hans-Halverson/following{/other_user}","gists_url":"https://api.github.com/users/Hans-Halverson/gists{/gist_id}","starred_url":"https://api.github.com/users/Hans-Halverson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hans-Halverson/subscriptions","organizations_url":"https://api.github.com/users/Hans-Halverson/orgs","repos_url":"https://api.github.com/users/Hans-Halverson/repos","events_url":"https://api.github.com/users/Hans-Halverson/events{/privacy}","received_events_url":"https://api.github.com/users/Hans-Halverson/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":97403606,"node_id":"MDU6TGFiZWw5NzQwMzYwNg==","url":"https://api.github.com/repos/electron/electron/labels/platform/macOS","name":"platform/macOS","color":"c7def8","default":false,"description":null},{"id":520323169,"node_id":"MDU6TGFiZWw1MjAzMjMxNjk=","url":"https://api.github.com/repos/electron/electron/labels/bug%20:beetle:","name":"bug :beetle:","color":"fbca04","default":false,"description":""},{"id":901782761,"node_id":"MDU6TGFiZWw5MDE3ODI3NjE=","url":"https://api.github.com/repos/electron/electron/labels/status/confirmed","name":"status/confirmed","color":"c2e0c6","default":false,"description":"A maintainer reproduced the bug or agreed with the feature"},{"id":2285277606,"node_id":"MDU6TGFiZWwyMjg1Mjc3NjA2","url":"https://api.github.com/repos/electron/electron/labels/has-repro-gist","name":"has-repro-gist","color":"c2e0c6","default":false,"description":"Issue can be reproduced with code at https://gist.github.com/"},{"id":6415544380,"node_id":"LA_kwDOAI8xS88AAAABfmVwPA","url":"https://api.github.com/repos/electron/electron/labels/component/WebContentsView","name":"component/WebContentsView","color":"f9d0c4","default":false,"description":""},{"id":6836511905,"node_id":"LA_kwDOAI8xS88AAAABl3zkoQ","url":"https://api.github.com/repos/electron/electron/labels/31-x-y","name":"31-x-y","color":"ededed","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"codebytere","id":2036040,"node_id":"MDQ6VXNlcjIwMzYwNDA=","avatar_url":"https://avatars.githubusercontent.com/u/2036040?v=4","gravatar_id":"","url":"https://api.github.com/users/codebytere","html_url":"https://github.com/codebytere","followers_url":"https://api.github.com/users/codebytere/followers","following_url":"https://api.github.com/users/codebytere/following{/other_user}","gists_url":"https://api.github.com/users/codebytere/gists{/gist_id}","starred_url":"https://api.github.com/users/codebytere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codebytere/subscriptions","organizations_url":"https://api.github.com/users/codebytere/orgs","repos_url":"https://api.github.com/users/codebytere/repos","events_url":"https://api.github.com/users/codebytere/events{/privacy}","received_events_url":"https://api.github.com/users/codebytere/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"codebytere","id":2036040,"node_id":"MDQ6VXNlcjIwMzYwNDA=","avatar_url":"https://avatars.githubusercontent.com/u/2036040?v=4","gravatar_id":"","url":"https://api.github.com/users/codebytere","html_url":"https://github.com/codebytere","followers_url":"https://api.github.com/users/codebytere/followers","following_url":"https://api.github.com/users/codebytere/following{/other_user}","gists_url":"https://api.github.com/users/codebytere/gists{/gist_id}","starred_url":"https://api.github.com/users/codebytere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codebytere/subscriptions","organizations_url":"https://api.github.com/users/codebytere/orgs","repos_url":"https://api.github.com/users/codebytere/repos","events_url":"https://api.github.com/users/codebytere/events{/privacy}","received_events_url":"https://api.github.com/users/codebytere/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-05-31T23:03:34Z","updated_at":"2024-07-30T23:21:21Z","closed_at":"2024-07-30T23:21:21Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Preflight Checklist\n\n- [X] I have read the [Contributing Guidelines](https://github.com/electron/electron/blob/main/CONTRIBUTING.md) for this project.\n- [X] I agree to follow the [Code of Conduct](https://github.com/electron/electron/blob/main/CODE_OF_CONDUCT.md) that this project adheres to.\n- [X] I have searched the [issue tracker](https://www.github.com/electron/electron/issues) for a bug report that matches the one I want to file, without success.\n\n### Electron Version\n\n31.0.0-beta.7\n\n### What operating system are you using?\n\nmacOS\n\n### Operating System Version\n\nmacOS Sonoma 14.4.1\n\n### What arch are you using?\n\narm64 (including Apple Silicon)\n\n### Last Known Working Electron version\n\n29 (with BrowserViews), vibrancy is currently broken with a separate bug in 30\n\n### Expected Behavior\n\nClick events on a WebContentsView should be detected when the BrowserWindow has vibrancy set on macOS. Depending on the version of Electron used for the attached gist, click events are either swallowed or cause the app to crash.\n\n### Actual Behavior\n\nClick events on the WebContentsView are not registered (or potentially cause the app to crash). If I remove the vibrancy setting from the BrowserWindow then click events start working again.\r\n\r\nIn the attached gist you can see this by trying to click the red square, which should display an alert due to an `onclick` handler (and does display the alert when vibrancy is disabled).\n\n### Testcase Gist URL\n\nhttps://gist.github.com/7f123c2282516503a73c7c0a43eb26d2\n\n### Additional Information\n\nLike https://github.com/electron/electron/issues/42335, this issue also appears to trace back to this PR: https://github.com/electron/electron/pull/41326. The bug in the attached gist is first seen in v31.0.0-nightly.20240305, and is not seen in v31.0.0-nightly.20240304 (and the only PR in between is https://github.com/electron/electron/pull/41326).\r\n\r\nHowever this is a bit more complicated because vibrancy still has [this bug](https://github.com/electron/electron/issues/41979) in v31.0.0-nightly.20240304 so the attached gist isn't functional, just for a different reason. I can confirm that if [this potential fix](https://github.com/electron/electron/pull/42263) for the vibrancy bug in Electron 30 is applied without https://github.com/electron/electron/pull/41326 then the click swallows/crashes in this issue are resolved.\r\n\r\nWhen using a debug build I see that click events crash the app on [this DCHECK](https://github.com/electron/electron/blob/31-x-y/shell/browser/ui/views/inspectable_web_contents_view_mac.mm#L15-L16) with [this stack trace](https://gist.github.com/Hans-Halverson/afdccf33795eff14e8b382d474df6379)","closed_by":{"login":"ckerr","id":70381,"node_id":"MDQ6VXNlcjcwMzgx","avatar_url":"https://avatars.githubusercontent.com/u/70381?v=4","gravatar_id":"","url":"https://api.github.com/users/ckerr","html_url":"https://github.com/ckerr","followers_url":"https://api.github.com/users/ckerr/followers","following_url":"https://api.github.com/users/ckerr/following{/other_user}","gists_url":"https://api.github.com/users/ckerr/gists{/gist_id}","starred_url":"https://api.github.com/users/ckerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ckerr/subscriptions","organizations_url":"https://api.github.com/users/ckerr/orgs","repos_url":"https://api.github.com/users/ckerr/repos","events_url":"https://api.github.com/users/ckerr/events{/privacy}","received_events_url":"https://api.github.com/users/ckerr/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/electron/electron/issues/42336/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/electron/electron/issues/42336/timeline","performed_via_github_app":null,"state_reason":"completed"}